<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title></title>
    
    <link rel="stylesheet" href="css/style.css" type="text/css" />
     
    
    <script src="js/lib/jquery-1.7.1.min.js"></script>
    <script src="js/lib/three.min.r53.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/lib/HexagonGeometry.js"></script>
    <script src="js/data.js"></script>
    
    <script type="x-shader/x-vertex" id="vertexShader">

        attribute vec4 center;
        varying vec4 vCenter;

        void main() {

            vCenter = center;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

        }
    </script>

    <script type="x-shader/x-fragment" id="fragmentShader">

        #extension GL_OES_standard_derivatives : enable

        varying vec4 vCenter;

        float edgeFactorTri() {

            vec3 d = fwidth( vCenter.xyz );
            vec3 a3 = smoothstep( vec3( 0.0 ), d * 1.5, vCenter.xyz );
            return min( min( a3.x, a3.y ), a3.z );

        }

        float edgeFactorQuad1() {

            vec2 d = fwidth( vCenter.xy );
            vec2 a2 = smoothstep( vec2( 0.0 ), d * 1.5, vCenter.xy );

            return min( a2.x, a2.y );

        }

        float edgeFactorQuad2() {

            vec2 d = fwidth( 1.0 - vCenter.xy );
            vec2 a2 = smoothstep( vec2( 0.0 ), d * 1.5, 1.0 - vCenter.xy );

            return min( a2.x, a2.y );
        }

        void main() {
            if ( vCenter.w == 0.0 ) {

                //gl_FragColor.rgb = mix( vec3( 1,1,1 ), vec3( 1,1,1 ), edgeFactorTri() );
                //gl_FragColor.rgb = vec3( 0.48,0.64,0.48 );
                gl_FragColor.rgb = vec3( 0.4,0.81,0.4 );
                gl_FragColor.rgb = vec3( 0.6,0.81,0.6 );
                gl_FragColor.rgb = vec3( 0.258,0.725,0.95 );
                gl_FragColor.a = 0.6;

            } else {

                //gl_FragColor.rgb = mix( vec3( 1,0,0 ), vec3( 1,0,0 ), min( edgeFactorQuad1(), edgeFactorQuad2() ) );
                gl_FragColor.rgb = vec3( 0.48,0.48,0.48 );
                gl_FragColor.rgb = vec3( 0.258,0.725,0.95 );
                gl_FragColor.rgb = vec3( 0.6,0.8,1.0 );
                gl_FragColor.a = 1.0;
                
            }
            
        }
    </script>
    
    <script type="x-shader/x-vertex" id="particlevertexshader">

        attribute float size;
        attribute vec3 ca;

        varying vec3 vColor;

        void main() {

            vColor = ca;

            vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

            gl_PointSize = size;
            //gl_PointSize = size * ( 300.0 / length( mvPosition.xyz ) );

            gl_Position = projectionMatrix * mvPosition;

        }

    </script>

    <script type="x-shader/x-fragment" id="particlefragmentshader">

        uniform vec3 color;
        uniform sampler2D texture;

        varying vec3 vColor;

        void main() {
            
            gl_FragColor = vec4( color * vColor, 1.0 );
            gl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord );
        }

    </script>
    
    <script src="js/test/sense_2.js"></script>
    
</head>
<body>
    <div id="webgl_div"></div>
    
    <script>
        //屏蔽鼠标事件，防止右键移动3d场景时弹出右键菜单
        document.oncontextmenu = function (){
            return false;
        }
        
        $(document).ready(function(){
            init();
            
            function init(){
                console.info('start');
                
                topo = new ClassTPlatform({
                    parentElementId: 'webgl_div'
                });
                
                var loader = new THREE.JSONLoader();
                
                loader.load( 'js/china_model.js', function ( geometry) {
                    topo.loadChinaModel(geometry);
                });
                
                document.onkeydown = topo.onKeyDown;
                
            }
            
            //$("#raphael_div").hide();
        });
    </script>
    
    
    
</body>
    <div id="raphael_div"></div>
</html>