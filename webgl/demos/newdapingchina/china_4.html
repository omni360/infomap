<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>ANTIY LABS</title>
        <link href="css/china_style.css" rel="stylesheet">
        <link href="css/china_table.css" rel="stylesheet">
        
        <script type="text/javascript" src="js/lib/jquery-1.7.2.min.js"></script>
        <script type="text/javascript" src="js/lib/raphael.js"></script>
        <script type="text/javascript" src="js/lib/highcharts.js"></script>
        
        <script type="text/javascript" src="js/lib/r50/three.min.js" charset="utf-8"></script>
        <script type="text/javascript" src="js/lib/Detector.js"></script>
        <script type="text/javascript" src="js/lib/Tween.js"></script>
        <script type="text/javascript" src="js/globe_v3_r50.js"></script>
        
        <script type="text/javascript" src="js/china_dark-green.js"></script>
        <script type="text/javascript" src="js/china_1200_960.js"></script>
        <script type="text/javascript" src="js/china_ready.js"></script>
        <script type="text/javascript" src="js/china_alarm.js"></script>
        <script type="text/javascript" src="js/china_data.js"></script>
        <script type="text/javascript" src="js/statis_data.js"></script>
        
        <style>
            #circle1 {
                position: absolute;
                top:60px;
                left:10px;
                z-index: 101;
            }
        </style>
        
        <script>
            function getAlarmData() {
                // for(var i = 0; i < alarm_list.length; i++){
                    // alert(alarm_list[i]);
                // }
                for (x in alarm_list) {
                    monitor_data = alarm_list[x];
                    /*
                    lon = monitor_data[2];
                    lat = monitor_data[3];
                    
                    monitor_location = getXY(parseFloat(lon), parseFloat(lat));
                    monitor_data.push(monitor_location['cx']);
                    monitor_data.push(monitor_location['cy']);
                    */
                    alarm_data.push(monitor_data);
                }
            }
            
            getXY = function (lon, lat) {
                // 中国地图实际大小，1125*941
                //北53.69
                //南18.15
                //西39.43
                //东134.63
                return {
                    cx: ((lon-39.43)*(1125)/95.2) - 45,//左侧多30
                    cy: ((53.69-lat)*(941)/35.54) + 18//上侧多10
                };
                
            };
            
            // 捕获数据列表   
            var alarm_data = [];
            getAlarmData();
            
            var world_width = 1900;
            var world_height = 960;
            var raphael,raphael1,raphael2;
            
            Raphael(10, 10, world_width, 40, function () {
                // 定义整体空间
                raphael1 = this;
                raphael1.rect(0, 0, world_width, world_height, 0).attr({
                    //fill:"#11567D",
                    //"fill-opacity": 1,
                    stroke: "#888",
                    "stroke-width": 0.5,
                    "stroke-linejoin": "round",
                    //fill: "#80f8eb",
                    fill:"0-#408988-#80f8eb",
                    "fill-opacity": 0.2,
                    "stroke-opacity": 0.0
                });
                //raphael1.text(950, 18, '  热 烈 欢 迎 市 领 导 莅 临 安 天 参 观 指 导').attr({fill: "#ff0000", "font-family":"微软雅黑", "font-size":36, "font-weight": "bold", "opacity": 0.8});
                //raphael1.text(930, 18, '热 烈 欢 迎 市 领 导').attr({fill: "#ff0000", "font-family":"微软雅黑", "font-size":36, "font-weight": "bold", "opacity": 0.8, "text-anchor":"end"});
                //raphael1.text(970, 18, '莅 临 安 天 参 观 指 导').attr({fill: "#ff0000", "font-family":"微软雅黑", "font-size":36, "font-weight": "bold", "opacity": 0.8, "text-anchor":"start"});
                raphael1.text(900, 18, '拢 态 势 于 眼 底').attr({fill: "#ff0000", "font-family":"微软雅黑", "font-size":36, "font-weight": "bold", "opacity": 0.8, "text-anchor":"end"});
                raphael1.text(1000, 18, '挫 威 胁 于 指 尖').attr({fill: "#ff0000", "font-family":"微软雅黑", "font-size":36, "font-weight": "bold", "opacity": 0.8, "text-anchor":"start"});
            });
            
            Raphael(10, 60, world_width, world_height, function () {
                // 定义整体空间
                raphael = this;
                raphael.rect(0, 0, 1440, 960, 0).attr({
                    stroke: "#11567D",
                    "stroke-width": 10,
                    "stroke-linejoin": "round",
                    fill: "#80f8eb",
                    //fill:"11567D",
                    "fill-opacity": 0.0,
                    "stroke-opacity": 0
                });
                
                raphael.rect(0, 0, 1440, 10, 0).attr({
                    //fill:"#11567D",
                    //"fill-opacity": 1,
                    stroke: "#888",
                    "stroke-width": 0.5,
                    "stroke-linejoin": "round",
                    //fill: "#80f8eb",
                    fill:"0-#408988-#80f8eb",
                    "fill-opacity": 0.2,
                    "stroke-opacity": 0.0
                });
                
                raphael.rect(0, 950, 1440, 10, 0).attr({
                    //fill:"#11567D",
                    //"fill-opacity": 1,
                    stroke: "#888",
                    "stroke-width": 0.5,
                    "stroke-linejoin": "round",
                    //fill: "#80f8eb",
                    fill:"0-#408988-#80f8eb",
                    "fill-opacity": 0.2,
                    "stroke-opacity": 0.0
                });
                
                
                //============================= 地图 ===========================
                
                /*
                 * 绘制地图
                 */
                raphael.setStart();
                for (var country in worldmap.shapes) {
                    raphael.path(worldmap.shapes[country]).attr({"stroke-linejoin": "round", stroke: "#80f8eb", fill: "#408988", "stroke-opacity": 1, "stroke-width": 1.0, "fill-opacity": 0.3}).data("name", worldmap.names[country]);
                }
                var world = raphael.setFinish();
                
                /*
                 * 底格横线
                 */ 
                
                for (var h = 0,i = 0; h <= 960; h += 40, i++ ) {
                    if(i%3==0 && i!=0 && i!= 24){
                        raphael.path("M0," + h + "L1440," + h).attr({stroke: "#4B8F88", "stroke-width": 1, "stroke-dasharray":"", "stroke-opacity": 0.8});
                    }
                    else{
                        if(i!=0 && i!= 24){
                            raphael.path("M0," + h + "L1440," + h).attr({stroke: "#4B8F88", "stroke-width": 1, "stroke-dasharray":"- ", "stroke-opacity": 0.6});
                        }
                        
                    }
                }
                
                
                /*
                 * 底格纵线
                 */
                
                for (var w = 0,i = 0; w <= 1440; w += 40, i++ ) {
                    if(i%3==0 && i !=0 && i!= 36){
                        raphael.path("M" + w + ",0L" + w + ",960").attr({stroke: "#4B8F88", "stroke-width": 1, "stroke-dasharray":"", "stroke-opacity": 0.8});
                    }
                    else{
                        if(i != 0&& i != 36){
                            raphael.path("M" + w + ",0L" + w + ",960").attr({stroke: "#4B8F88", "stroke-width": 1, "stroke-dasharray":"- ", "stroke-opacity": 0.6});
                        }
                        
                    }
                }
                
                
                /*
                 * 底格十字光晕
                 */
                
                var d_x = 0,
                    d_y = 0;
                for (var w = 120; w < 1440; w += 120) {
                    for (var h = 0; h < 960; h += 120) {
                        if(h !=0 ){
                            raphael.path("M" + w + "," + (h-5) + "L" + w + "," + (h+5)).attr({stroke: "#80f8eb", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.25});
                            raphael.path("M" + (w-5) + "," + h + "L" + (w+5) + "," + h).attr({stroke: "#80f8eb", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.25});
                        }
                    }
                }
                
                
                /*
                 * 背景竖杠
                 */
                var flash_cx = 0,
                    flash_item_width = 20;
                
                for (var i = 0; i < 72; i++) {
                    raphael.rect(flash_cx, 0, flash_item_width, 960, 0).attr({ fill: "#80f8eb", "fill-opacity": 0});
                    flash_cx += flash_item_width;
                }
                
                /*
                 * 左下比例尺
                 */
                /*
                raphael.text(48, 740, 'N').attr({fill: "#ffffff", "font-size":20, "font-weight": "bold","opacity": 0.7});
                raphael.text(300, 913, 'E').attr({fill: "#ffffff", "font-size":20, "font-weight": "bold","opacity": 0.7});
                
                raphael.path("M40,760L40,920").attr({stroke: "#ffffff", "stroke-width": 2, "stroke-opacity": 0.7}).glow({color:"#80f8eb", width:8, opacity:0.25});
                raphael.path("M40,920L280,920").attr({stroke: "#ffffff", "stroke-width": 2, "stroke-opacity": 0.7}).glow({color:"#80f8eb", width:8, opacity:0.25});
                
                //raphael.path("M40,720L60,720").attr({stroke: "#ffffff", "stroke-width": 3, "stroke-opacity": 0.7}).glow({color:"#80f8eb", width:8, opacity:0.25});
                raphael.path("M40,760L55,760").attr({stroke: "#ffffff", "stroke-width": 2, "stroke-opacity": 0.7});
                raphael.path("M40,800L55,800").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M40,840L55,840").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M40,880L55,880").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                
                //raphael.path("M40,740L55,740").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7}).glow({color:"#80f8eb", width:8, opacity:0.25});
                raphael.path("M40,780L50,780").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M40,820L50,820").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M40,860L50,860").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                
                raphael.path("M80,920L80,905").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M120,920L120,905").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M160,920L160,905").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M200,920L200,905").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M240,920L240,905").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M280,920L280,905").attr({stroke: "#ffffff", "stroke-width": 2, "stroke-opacity": 0.7});
                
                raphael.path("M100,920L100,910").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M140,920L140,910").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M180,920L180,910").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M220,920L220,910").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                raphael.path("M260,920L260,910").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.7});
                */
                
                
                /*
                 * 左侧地图小模块
                 */
                var map_param = {
                    /*
                    //fill:"#11567D",
                    "fill-opacity": 0.3,
                    //stroke: "#888",
                    //"stroke-width": 0.5,
                    //"stroke-linejoin": "round",
                    fill: "#11567D",
                    //fill:"0-#408988-#80f8eb",
                    //"fill-opacity": 0.1,
                    //"stroke-opacity": 0.0
                    */
                    stroke: "#888",
                    "stroke-width": 0.5,
                    "stroke-linejoin": "round",
                    //fill: "#80f8eb",
                    fill:"#11567D",
                    "fill-opacity": 0.2,
                    "stroke-opacity": 0.0
                };
                raphael.rect(1320, 0, 120, 110, 0).attr(map_param);
                raphael.rect(1320, 120, 120, 110, 0).attr(map_param);
                raphael.rect(1320, 240, 120, 110, 0).attr(map_param);
                raphael.rect(1320, 360, 120, 110, 0).attr(map_param);
                raphael.rect(1320, 480, 120, 110, 0).attr(map_param);
                raphael.rect(1320, 600, 120, 110, 0).attr(map_param);
                
                loop_param = {stroke: "#fff", "stroke-width": 30};
                
                draw_loop(raphael, 1380, 60, 30, 42, "#ff0000", "#2FBFBF", 234);
                raphael.text(1380, 50, 'Trojan').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.text(1380, 70, '65%').attr({fill: "#80f8eb", "font-size":10, "font-weight": "bold"});
                //raphael.circle(1380, 60, 48).attr({stroke: "#80f8eb", "stroke-width": 2, "stroke-opacity": 0.8});
                
                draw_loop(raphael, 1380, 180, 30, 42, "#ff0000", "#2FBFBF", 61);
                raphael.text(1380, 170, 'Virus').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.text(1380, 190, '17%').attr({fill: "#80f8eb", "font-size":10, "font-weight": "bold"});
                //raphael.circle(1380, 180, 48).attr({stroke: "#80f8eb", "stroke-width": 2, "stroke-opacity": 0.8});
                
                draw_loop(raphael, 1380, 300, 30, 42, "#ff0000", "#2FBFBF", 32);
                raphael.text(1380, 290, 'Worm').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.text(1380, 310, '9%').attr({fill: "#80f8eb", "font-size":10, "font-weight": "bold"});
                //raphael.circle(1380, 300, 48).attr({stroke: "#ffffff", "stroke-width": 2, "stroke-opacity": 0.8});
                
                draw_loop(raphael, 1380, 420, 30, 42, "#ff0000", "#2FBFBF", 14);
                raphael.text(1380, 410, 'Spyware').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.text(1380, 430, '4%').attr({fill: "#80f8eb", "font-size":10, "font-weight": "bold"});
                
                draw_loop(raphael, 1380, 540, 30, 42, "#ff0000", "#2FBFBF", 4);
                raphael.text(1380, 530, 'Hacktool').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.text(1380, 550, '1%').attr({fill: "#80f8eb", "font-size":10, "font-weight": "bold"});
                
                draw_loop(raphael, 1380, 660, 30, 42, "#ff0000", "#2FBFBF", 4);
                raphael.text(1380, 650, 'X-Files').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.text(1380, 670, '1%').attr({fill: "#80f8eb", "font-size":10, "font-weight": "bold"});
                
                
                //============================= 地图 ===========================
                
                
                
                
                //=============================> 地图雷达 ===========================
                spinner( raphael );
                function spinner(r ) {
                    var sectorsCount = 24,
                        color = "#80f8eb",
                        width = 1,
                        r1 = 50,
                        r2 = 700,
                        cx = 600,
                        cy = 480,
                        sectors = [],
                        opacity = [],
                        opacity_1 = []
                        beta = 2 * Math.PI / sectorsCount,
                        pathParams = {
                            //stroke: "#888",
                            "stroke-width": 0.5,
                            //"stroke-linejoin": "round",
                            fill: color,
                            "fill-opacity": 0.0,
                            "stroke-opacity": 0.0
                        };
                        Raphael.getColor.reset();
                    
                    r.customAttributes.segment = function (x, y, r, a1, a2) {
                        var flag = (a2 - a1) > 180,
                            clr = (a2 - a1) / 360;
                        a1 = (a1 % 360) * Math.PI / 180;
                        a2 = (a2 % 360) * Math.PI / 180;
                        return {
                            path: [["M", x, y], ["l", r * Math.cos(a1), r * Math.sin(a1)], ["A", r, r, 0, +flag, 1, x + r * Math.cos(a2), y + r * Math.sin(a2)], ["z"]],
                            fill: color
                        };
                    };
                    
                    circle_r = (r2 * 2 + width * 2)/2
                    r.circle(cx, cy, 50).attr({stroke: "#88ffcc", "stroke-width": 1, "stroke-opacity": 0.8}).glow({color:"#80f8eb", width:8,opacity:0.25});
                    r.circle(cx, cy, 200).attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.5});
                    r.circle(cx, cy, 300).attr({stroke: "#80f8eb", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.25});
                    r.circle(cx, cy, 400).attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.5});
                    r.circle(cx, cy, 520).attr({stroke: "#80f8eb", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.25});
                    r.circle(cx, cy, 620).attr({stroke: "#ffffff", "stroke-width": 1, "stroke-opacity": 0.8}).glow({color:"#80f8eb", width:8,opacity:0.5});
                    
                    var paths = [],
                        start = 0,
                        val = 360 / sectorsCount;
                    
                    for (var i = 0; i < sectorsCount; i++) {
                        var alpha = beta * i - Math.PI / 2,
                            cos = Math.cos(alpha),
                            sin = Math.sin(alpha);
                        if(i < 6){
                            //opacity[i] = 4 / sectorsCount * i;
                        }
                        //else{
                        //    opacity[i] = 0;
                        //}
                        if(i%3 == 0){
                            sectors[i] = r.path([["M", cx + r1 * cos, cy + r1 * sin], ["L", cx + r2 * cos, cy + r2 * sin]]).attr({stroke: "#80f8eb", "stroke-width": 1, "stroke-opacity": 0.5}).glow({color:"#80f8eb", width:8,opacity:0.25});
                        }
                        else{
                            sectors[i] ='';
                        }
                        
                        
                        
                        start += val;
                    }
                    
                    var now_path_num = 0,
                        temp_num = 0;
                    var tick;
                    (function ticker() {
                        
                    })();
                    return function () {
                        clearTimeout(tick);
                        r.remove();
                    };
                }
                
                //<============================= 地图雷达 ===========================
                
                
                //>============================= 地图雷达刷新告警 ===========================
                // 捕获数据列表   
                /*
                var alarm_data = [
                    {cx:1046, cy:198, color:2},
                    {cx:710, cy:454, color:2},
                    {cx:940, cy:754, color:3},
                    {cx:810, cy:554, color:3},
                    {cx:735, cy:414, color:2},
                    {cx:750, cy:814, color:2},
                    {cx:530, cy:454, color:2},
                    {cx:550, cy:524, color:3},
                    {cx:610, cy:654, color:3},
                    {cx:868, cy:375, color:3},
                    {cx:670, cy:744, color:3},
                    {cx:870, cy:834, color:3},
                    {cx:840, cy:564, color:2},
                    {cx:978, cy:606, color:3},
                    {cx:860, cy:492, color:2},
                    {cx:960, cy:754, color:2},
                    {cx:635, cy:714, color:3},
                    {cx:1046, cy:198, color:2},
                    {cx:610, cy:554, color:2},
                    {cx:950, cy:426, color:2},
                    {cx:730, cy:454, color:2},
                    {cx:460, cy:532, color:2},
                    {cx:450, cy:514, color:3},
                    {cx:670, cy:544, color:2},
                    {cx:740, cy:564, color:3},
                    {cx:630, cy:554, color:2},
                    {cx:850, cy:514, color:2},
                    {cx:635, cy:514, color:3},
                    {cx:835, cy:314, color:2},
                    {cx:868, cy:375, color:3},
                    {cx:940, cy:764, color:3},
                    {cx:860, cy:554, color:3}
                ];
                */
                
                

                
                //<============================= 地图雷达刷新告警 ===========================
                
                
                
                //============================= 右侧信息区 =================================
                var info_param = {
                    /*
                    //fill:"#11567D",
                    "fill-opacity": 0.3,
                    //stroke: "#888",
                    //"stroke-width": 0.5,
                    //"stroke-linejoin": "round",
                    fill: "#11567D",
                    //fill:"0-#408988-#80f8eb",
                    //"fill-opacity": 0.1,
                    //"stroke-opacity": 0.0
                    */
                    stroke: "#888",
                    "stroke-width": 0.5,
                    "stroke-linejoin": "round",
                    //fill: "#80f8eb",
                    fill:"#2FBFBF",
                    //fill:"#11567D",
                    "fill-opacity": 0.15,
                    "stroke-opacity": 0.0
                };
                
                
                /*
                 * 右侧统计模块
                 */
                raphael.rect(1470, 5, 430, 220, 0).attr(info_param);
                draw_statistics_div(raphael, china_statis);
                
                
                /*
                 * 套圈图
                 */
                raphael.rect(1470, 235, 215, 195, 0).attr(info_param);
                raphael.circle(1575, 330, 70).attr({stroke: "#ae442e", "stroke-width": 1, fill:"#ae442e","fill-opacity": 0.5, "stroke-opacity": 0.9});
                raphael.text(1575, 295, '本年').attr({fill: "#ffffff", "font-size":12, "font-weight": "bold"});
                raphael.circle(1575, 360, 40).attr({stroke: "#ae442e", "stroke-width": 1, fill:"#ae442e","fill-opacity": 0.7, "stroke-opacity": 0.9});
                raphael.text(1575, 340, '本月').attr({fill: "#ffffff", "font-size":11, "font-weight": "bold"});
                raphael.circle(1575, 380, 20).attr({stroke: "#b03317", "stroke-width": 1, fill:"#b03317","fill-opacity": 1, "stroke-opacity": 0.9});
                raphael.text(1575, 380, '本周').attr({fill: "#ffffff", "font-size":10, "font-weight": "bold"});
                
                raphael.path("M1590,295L1620,295,L1625,290").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-dasharray":"- ", "stroke-opacity": 1});
                raphael.rect(1620, 270, 60, 20, 0).attr({fill:"#ae442e","fill-opacity": 0.5, "stroke-opacity": 0.0});
                raphael.text(1650, 280, '8,768,901').attr({fill: "#ffffff", "font-size":10, "font-weight": "bold", "text-anchor":"middle"});
                
                raphael.path("M1590,340L1620,340,L1625,335").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-dasharray":"- ", "stroke-opacity": 1});
                raphael.rect(1620, 315, 60, 20, 0).attr({fill:"#ae442e","fill-opacity": 0.7, "stroke-opacity": 0.0});
                raphael.text(1650, 325, '95,616').attr({fill: "#ffffff", "font-size":10, "font-weight": "bold", "text-anchor":"middle"});
                
                raphael.path("M1590,380L1620,380,L1625,375").attr({stroke: "#ffffff", "stroke-width": 1, "stroke-dasharray":"- ", "stroke-opacity": 1});
                raphael.rect(1620, 355, 60, 20, 0).attr({fill:"#b03317","fill-opacity": 1, "stroke-opacity": 0.0});
                raphael.text(1650, 365, '50,855').attr({fill: "#ffffff", "font-size":10, "font-weight": "bold", "text-anchor":"middle"});
                
                /*
                 * 花瓣图
                 */
                //wind_rose("",1500,300, 10, 70, 24, 1, "#357B5A");
                raphael.rect(1695, 235, 205, 195, 0).attr(info_param);
                //var data_1 = [10, 12, 13, 24, 25, 36, 37, 48, 49, 50, 50, 62, 63, 74, 75, 86, 87, 98, 99, 20, 21, 22, 23, 24];
                var data_1 = [1350
                    ,903
                    ,751
                    ,771
                    ,495
                    ,371
                    ,373
                    ,372
                    ,568
                    ,767
                    ,1111
                    ,1387
                    ,1461
                    ,1318
                    ,1446
                    ,1360
                    ,1388
                    ,1417
                    ,1953
                    ,1861
                    ,2115
                    ,2267
                    ,1780
                    ,1475
                ];//2012年10月31日放马事件真实数据
                wind_rose("",1720,300, 10, 70, 24, 1, "#80f8eb", data_1);
                
                
                /*
                 * 排行
                 */
                raphael.rect(1470, 440, 430, 240, 0).attr(info_param);
                var box_param = {
                    stroke: "#ffffff",
                    "stroke-width": 1,
                    "stroke-linejoin": "round",
                    "fill-opacity": 0,
                }
                
                raphael.text(1700, 455, '恶意代码家族规模排行(Trojan)').attr({fill: "#ffffff", "font-size":14, "font-weight": "bold"});
                /*
                raphael.rect(1490, 475, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 495, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 515, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 535, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 555, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 575, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 595, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 615, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 635, 40, 16, 0).attr(box_param);
                raphael.rect(1490, 655, 40, 16, 0).attr(box_param);
                
                raphael.text(1510, 482, '1').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 502, '2').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 522, '3').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 542, '4').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 562, '5').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 582, '6').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 602, '7').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 622, '8').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 642, '9').attr({fill: "#ffffff", "font-size":12});
                raphael.text(1510, 662, '10').attr({fill: "#ffffff", "font-size":12});
                */
                raphael.text(1670, 482, 'Trojan/Win32.Genome').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 502, 'Trojan/Win32.Jorik').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 522, 'Trojan/Win32.Hupigon[Backdoor]').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 542, 'Trojan/Win32.FakeAV').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 562, 'Trojan/Win32.VBKrypt').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 582, 'Trojan/Win32.Agent').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 602, 'Trojan/Win32.Injector[Dropper]').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 622, 'Trojan/Win32.Zbot[Spy]').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 642, 'Trojan/Win32.Agent[Downloader]').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                raphael.text(1670, 662, 'Trojan/Win32.OnLineGames[GameThief]').attr({fill: "#ffffff", "font-size":10, "text-anchor":"end"});
                
                
                var column_param = {
                    stroke: "#ffffff",
                    fill:"#b03317",
                    "fill-opacity": 1,
                    "stroke-opacity": 0
                }
                
                //raphael.rect(1530, 450, 85, 8, 0).attr(column_param);
                raphael.rect(1680, 475, 180, 6, 0).attr(column_param);
                raphael.rect(1680, 495, 65, 6, 0).attr(column_param);
                raphael.rect(1680, 515, 50, 6, 0).attr(column_param);
                raphael.rect(1680, 535, 40, 6, 0).attr(column_param);
                raphael.rect(1680, 555, 30, 6, 0).attr(column_param);
                raphael.rect(1680, 575, 25, 6, 0).attr(column_param);
                raphael.rect(1680, 595, 20, 6, 0).attr(column_param);
                raphael.rect(1680, 615, 18, 6, 0).attr(column_param);
                raphael.rect(1680, 635, 16, 6, 0).attr(column_param);
                raphael.rect(1680, 655, 14, 6, 0).attr(column_param);
                
                
                /*
                 * 信号灯图
                 */
                /*
                raphael.rect(1470, 440, 170, 240, 0).attr(info_param);
                
                var box_param = {
                    stroke: "#ffffff",
                    "stroke-width": 1,
                    "stroke-linejoin": "round",
                    "fill-opacity": 0,
                }
                
                raphael.rect(1480, 450, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 475, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 500, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 525, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 550, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 575, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 600, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 625, 40, 20, 0).attr(box_param);
                raphael.rect(1480, 650, 40, 20, 0).attr(box_param);
                
                var column_param = {
                    stroke: "#357B5A",
                    fill:"#357B5A",
                    "fill-opacity": 1,
                    "stroke-opacity": 0.0
                }
                
                //raphael.rect(1530, 450, 85, 8, 0).attr(column_param);
                raphael.rect(1530, 465, 75, 8, 0).attr(column_param);
                raphael.rect(1530, 480, 65, 8, 0).attr(column_param);
                raphael.rect(1530, 495, 50, 8, 0).attr(column_param);
                raphael.rect(1530, 510, 40, 8, 0).attr(column_param);
                raphael.rect(1530, 525, 30, 8, 0).attr(column_param);
                raphael.rect(1530, 540, 25, 8, 0).attr(column_param);
                raphael.rect(1530, 555, 20, 8, 0).attr(column_param);
                raphael.rect(1530, 570, 18, 8, 0).attr(column_param);
                raphael.rect(1530, 585, 16, 8, 0).attr(column_param);
                raphael.rect(1530, 600, 14, 8, 0).attr(column_param);
                raphael.rect(1530, 615, 12, 8, 0).attr(column_param);
                raphael.rect(1530, 630, 10, 8, 0).attr(column_param);
                raphael.rect(1530, 645, 8, 8, 0).attr(column_param);
                raphael.rect(1530, 660, 6, 8, 0).attr(column_param);
                */
                
                /*
                 * 地球背景背景
                 */
                // raphael.rect(1470, 690, 430, 230, 0).attr(info_param);
                
                /*
                 * 塔图
                 */
                /*
                drawTower(raphael, 1775,470, "#80f8eb");
                drawTower(raphael, 1695,600, "#80f8eb");
                drawTower(raphael, 1855,600, "#80f8eb");
                raphael.path("M" + 1775 + "," + 470 + "L" + 1695 + "," + 600).attr({stroke: "#5EAC9D", "stroke-width": 2, "stroke-opacity": 1, "stroke-dasharray":"- "});
                raphael.path("M" + 1775 + "," + 470 + "L" + 1855 + "," + 600).attr({stroke: "#5EAC9D", "stroke-width": 2, "stroke-opacity": 1, "stroke-dasharray":"- "});
                raphael.path("M" + 1695 + "," + 600 + "L" + 1855 + "," + 600).attr({stroke: "#5EAC9D", "stroke-width": 2, "stroke-opacity": 1, "stroke-dasharray":"- "});
                
                raphael.rect(1650, 440, 250, 240, 0).attr(info_param);
                
                function drawTower (rap, circle_x, circle_y, storke_color) {
                    var tower_x = circle_x,
                        tower_y = circle_y + 5
                    
                    
                    var left_x = tower_x - 20,
                        left_y = tower_y + 50,
                        right_x = tower_x + 20,
                        right_y = tower_y + 50;
                    
                    rap.path("M" + tower_x + "," + tower_y + "L" + left_x + "," + left_y).attr({stroke: storke_color, "stroke-width": 2, "stroke-opacity": 1});
                    rap.path("M" + tower_x + "," + tower_y + "L" + right_x + "," + right_y).attr({stroke: storke_color, "stroke-width": 2, "stroke-opacity": 1});
                    
                    var left_middle_1_x = (tower_x + left_x)/2;
                    var left_middle_1_y = (tower_y + left_y)/2;
                    var right_middle_1_x = (tower_x + right_x)/2;
                    var right_middle_1_y = (tower_y + right_y)/2;
                    rap.path("M" + left_middle_1_x + "," + left_middle_1_y + "L" + right_middle_1_x + "," + right_middle_1_y).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    
                    var left_middle_2_x = (tower_x + left_middle_1_x)/2;
                    var left_middle_2_y = (tower_y + left_middle_1_y)/2;
                    var right_middle_2_x = (tower_x + right_middle_1_x)/2;
                    var right_middle_2_y = (tower_y + right_middle_1_y)/2;
                    rap.path("M" + left_middle_2_x + "," + left_middle_2_y + "L" + right_middle_2_x + "," + right_middle_2_y).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    
                    var left_middle_3_x = (left_x + left_middle_1_x)/2;
                    var left_middle_3_y = (left_y + left_middle_1_y)/2;
                    var right_middle_3_x = (right_x + right_middle_1_x)/2;
                    var right_middle_3_y = (right_y + right_middle_1_y)/2;
                    rap.path("M" + left_middle_3_x + "," + left_middle_3_y + "L" + right_middle_3_x + "," + right_middle_3_y).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    
                    
                    
                    rap.circle(circle_x, circle_y).attr({stroke: storke_color,"stroke-width": 2, r: 5}).glow({color:"#ffffff",opacity:0.6});
                    
                    var d1 = 35,
                        d2 = 145,
                        d3 = 215,
                        d4 = 325,
                        R1 = 10,
                        R2 = 15,
                        R3 = 20;
                    
                    d1 = d1 + 270;
                    d2 = d2 + 270;
                    a1 = (d1 % 360) * Math.PI / 180;
                    a2 = (d2 % 360) * Math.PI / 180;
                    
                    d3 = d3 + 270;
                    d4 = d4 + 270;
                    a3 = (d3 % 360) * Math.PI / 180;
                    a4 = (d4 % 360) * Math.PI / 180;
                    
                    var tx1R1 = circle_x + R1 * Math.cos(a1);
                    var ty1R1 = circle_y + R1 * Math.sin(a1);
                    var tx2R1 = circle_x + R1 * Math.cos(a2);
                    var ty2R1 = circle_y + R1 * Math.sin(a2);
                    
                    var tx1R2 = circle_x + R2 * Math.cos(a1);
                    var ty1R2 = circle_y + R2 * Math.sin(a1);
                    var tx2R2 = circle_x + R2 * Math.cos(a2);
                    var ty2R2 = circle_y + R2 * Math.sin(a2);
                    
                    var tx1R3 = circle_x + R3 * Math.cos(a1);
                    var ty1R3 = circle_y + R3 * Math.sin(a1);
                    var tx2R3 = circle_x + R3 * Math.cos(a2);
                    var ty2R3 = circle_y + R3 * Math.sin(a2);
                    
                    rap.path("M" + tx1R1 + "," + ty1R1 + "A" + R1 + ", " + R1 + ", 0, 0, 1," + tx2R1 + "," + ty2R1).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    rap.path("M" + tx1R2 + "," + ty1R2 + "A" + R2 + ", " + R2 + ", 0, 0, 1," + tx2R2 + "," + ty2R2).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    rap.path("M" + tx1R3 + "," + ty1R3 + "A" + R3 + ", " + R3 + ", 0, 0, 1," + tx2R3 + "," + ty2R3).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1}).glow({color:"#ffffff",opacity:0.6});
                    
                    var tx3R1 = circle_x + R1 * Math.cos(a3);
                    var ty3R1 = circle_y + R1 * Math.sin(a3);
                    var tx4R1 = circle_x + R1 * Math.cos(a4);
                    var ty4R1 = circle_y + R1 * Math.sin(a4);
                    
                    var tx3R2 = circle_x + R2 * Math.cos(a3);
                    var ty3R2 = circle_y + R2 * Math.sin(a3);
                    var tx4R2 = circle_x + R2 * Math.cos(a4);
                    var ty4R2 = circle_y + R2 * Math.sin(a4);
                    
                    var tx3R3 = circle_x + R3 * Math.cos(a3);
                    var ty3R3 = circle_y + R3 * Math.sin(a3);
                    var tx4R3 = circle_x + R3 * Math.cos(a4);
                    var ty4R3 = circle_y + R3 * Math.sin(a4);
                    
                    rap.path("M" + tx3R1 + "," + ty3R1 + "A" + R1 + ", " + R1 + ", 0, 0, 1," + tx4R1 + "," + ty4R1).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    rap.path("M" + tx3R2 + "," + ty3R2 + "A" + R2 + ", " + R2 + ", 0, 0, 1," + tx4R2 + "," + ty4R2).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1});
                    rap.path("M" + tx3R3 + "," + ty3R3 + "A" + R3 + ", " + R3 + ", 0, 0, 1," + tx4R3 + "," + ty4R3).attr({stroke: storke_color, "stroke-width": 1, "stroke-opacity": 1}).glow({color:"#80f8eb",opacity:0.6});
                }
                */
            });
            
            /*
             * 底部边框
             */
            
            Raphael(10, 1030, 1440, 40, function () {
                // 定义整体空间
                raphael2 = this;
                /*
                raphael2.rect(0, 0, world_width, world_height, 0).attr({
                    stroke: "#888",
                    "stroke-width": 0.5,
                    "stroke-linejoin": "round",
                    fill:"11567D",
                    "fill-opacity": 0.3,
                    "stroke-opacity": 0.0
                });
                */
               

                   //fill: "#80f8eb",
                   //"fill-opacity": 0.8, 

               var bottom_border_param_1 = {
                   stroke: "#ffffff", 
                   "stroke-width": 0, 
                   "stroke-opacity":0,
                   fill: "#408988",
                   "fill-opacity": 0.9, 
               };
               var bottom_border_param_2 = {
                   stroke: "#11567D", 
                   "stroke-width": 0, 
                   "stroke-opacity":0,
                   fill: "#408988",
                   "fill-opacity": 0.4,
               };
               
               raphael2.path("M60,15L70,15L70,20L170,20L170,15L180,15L180,20L180,25,L60,25z").attr(bottom_border_param_1);
               raphael2.path("M180,20L300,20L300,25,L180,25z").attr(bottom_border_param_2);
               raphael2.path("M300,15L310,15L310,20L410,20L410,15L420,15L420,20L420,25,L300,25z").attr(bottom_border_param_1);
               raphael2.path("M420,20L540,20L540,25,L420,25z").attr(bottom_border_param_2);
               raphael2.path("M540,15L550,15L550,20L650,20L650,15L660,15L660,20L660,25,L540,25z").attr(bottom_border_param_1);
               raphael2.path("M660,20L780,20L780,25,L660,25z").attr(bottom_border_param_2);
               raphael2.path("M780,15L790,15L790,20L890,20L890,15L900,15L900,20L900,25,L780,25z").attr(bottom_border_param_1);
               raphael2.path("M900,20L1020,20L1020,25,L900,25z").attr(bottom_border_param_2);
               raphael2.path("M1020,15L1030,15L1030,20,L1130,20L1130,15L1140,15L1140,20L1140,25,L1020,25z").attr(bottom_border_param_1);
               raphael2.path("M1140,20L1260,20L1260,25,L1140,25z").attr(bottom_border_param_2);
               raphael2.path("M1260,15L1270,15L1270,20L1370,20L1370,15L1380,15L1380,20L1380,25,L1260,25z").attr(bottom_border_param_1);
               
            });
            
            /*
             * 绘制花瓣图
             */
            function wind_rose(holderid, x, y, r1, r2, count, stroke_width, colour, data) {
                var sectorsCount = count || 12,
                    color = colour || "#fff",
                    width = stroke_width || 15,
                    cx = r2 + width + 20,//中心点横坐标
                    cy = r2 + width + 20,//中心点纵坐标
                    beta = 2 * Math.PI / sectorsCount;
                    
                
                // 兼容两种定位方法
                if(holderid != ""){
                    r = Raphael(holderid, r2 * 2 + width * 2 + 35, r2 * 2 + width * 2 + 35);//周围有数字，所以加上30的偏移量
                }
                else{
                    r = Raphael(x, y, r2 * 2 + width * 2 + 35, r2 * 2 + width * 2 + 35);//周围有数字，所以加上30的偏移量
                }                    
                    
                var paths = r.set();
                    
                // 绘制每个wind_rose花瓣的函数
                r.customAttributes.draw_wind_rose = function (cx, cy, r, R, d1, d2, the_color) {
                    /* 
                     * cx, cy为中心点坐标
                     * r为内圆半径。R为wind_rose花瓣的半径，注意，不是圆的半径
                     * d1起点角度
                     * d2终点角度
                     * the_color为wind_rose的颜色。默认为统一的 */
                    d1 = d1 + 270;
                    d2 = d2 + 270;
                    a1 = (d1 % 360) * Math.PI / 180;
                    a2 = (d2 % 360) * Math.PI / 180;
                    
                    /*
                     * 计算四个点的坐标
                     * */
                    var tx1 = cx + r * Math.cos(a1);
                    var ty1 = cy + r * Math.sin(a1);
                    var tx2 = cx + R * Math.cos(a1);
                    var ty2 = cy + R * Math.sin(a1);
                    var tx3 = cx + R * Math.cos(a2);
                    var ty3 = cy + R * Math.sin(a2);
                    var tx4 = cx + r * Math.cos(a2);
                    var ty4 = cy + r * Math.sin(a2);
                    
                    return {
                        path: [["M", tx1, ty1], ["L", tx2, ty2], ["A", R, R, 0, 0, 1, tx3, ty3], ["L", tx4, ty4], ["z"]],
                        fill: the_color
                    };
                }
                
                /*
                 * 绘制底色圆
                 * */
                var temp_r = (r2 - r1)/100;
                r.circle(cx, cy, r1).attr({stroke: "#507973", "stroke-width": 1});
                r.circle(cx, cy, r2 - 65*temp_r).attr({stroke: "#80f8eb", "stroke-width": 1});
                r.circle(cx, cy, r2 - 50*temp_r).attr({stroke: "#507973", "stroke-width": 1});
                r.circle(cx, cy, r2 - 35*temp_r).attr({stroke: "#80f8eb", "stroke-width": 1});
                r.circle(cx, cy, r2 - 20*temp_r).attr({stroke: "#507973", "stroke-width": 1});
                r.circle(cx, cy, r2).attr({stroke: "#80f8eb", "stroke-width": 1});
                
                /*
                 * 绘制外圆外的刻度和底线，可以和下面的合在一起。
                 * */
                for (var i = 0; i < sectorsCount; i++) {
                    var alpha = beta * i - Math.PI / 2,
                        cos = Math.cos(alpha),
                        sin = Math.sin(alpha);
                    // 绘线
                    //r.path([["M", cx + r1 * cos, cy + r1 * sin], ["L", cx + r2 * cos, cy + r2 * sin]]).attr({stroke: "#3c0", "stroke-width": 1, "stroke-linecap": "round"});
                    
                    r3 = r2 + 8;
                    if(i%2 == 0){
                        if(i == 0){
                            r.text(cx + r3 * cos, cy + r3 * sin, 24).attr({fill: "#80f8eb", "font-size":12, "font-weight": "bold"});
                        }
                        else{
                            r.text(cx + r3 * cos, cy + r3 * sin, i).attr({fill: "#80f8eb", "font-size":12, "font-weight": "bold"});
                        }
                    }
                }
                
                
                var max_data,//最大的数据。计算比例用
                    start_angle = 0,//起始角度
                    r_data,//花瓣的半径
                    //每个花瓣的角度
                    val = 360/sectorsCount;
                    // 不同数据不同颜色。
                    the_colors = ["rgb(132, 166, 233)", "rgb(117, 155, 231)", "rgb(116, 155, 231)", "rgb(112, 151, 230)", "rgb(128, 163, 233)","rgb(120, 157, 231)", 
                        "rgb(188, 206, 243)", "rgb(192, 209, 244)", "rgb(188, 207, 243)", "rgb(185, 204, 243)", "rgb(187, 206, 243)", "rgb(185, 204, 243)", 
                        "rgb(178, 199, 241)", "rgb(177, 199, 241)", "rgb(171, 194, 240)", "rgb(164, 189, 239)", "rgb(139, 171, 235)", "rgb(95, 139, 227)", 
                        "rgb(113, 152, 230)", "rgb(136, 169, 234)", "rgb(138, 170, 234)", "rgb(148, 177, 236)", "rgb(151, 179, 237)", "rgb(143, 174, 235)"];
                
                //data = data.sort(function (a, b) { return b - a;});
                
                /*
                 * 循环一下最大值。
                 * */
                max_data = 0;
                for (var i = 0, ii = data.length; i < ii; i++) {
                    if (data[i] > max_data){
                        max_data = data[i];
                    }
                }
                
                /*
                 * 绘制花瓣。
                 * */
                for (i = 0; i < sectorsCount; i++) {
                    (function (i, val) {
                        if(data[i] != 0 || data[i] != undefined){
                            r_data = data[i]/max_data*(r2 - r1) + r1;
                        }
                        else{
                            r_data = r1;
                        }
                        var ttt = r.path().attr({draw_wind_rose: [cx, cy, r1, r_data, start_angle, start_angle + val, colour], stroke: colour, "stroke-width": 1.5, "stroke-opacity": 0.9,"opacity":0.5});
                         paths.push(ttt);
                    })(i, val);
                    start_angle += val;
                }
                
                var temp_int = 0;
                
                var show_tick;
                function show_ticker() {
                    if(temp_int < sectorsCount){
                        paths[temp_int].attr("opacity", 0.5);
                        temp_int += 1;
                        r.safari();
                        show_tick = setTimeout(show_ticker, 800 / sectorsCount);
                    }
                };
                
                var tick;
                (function ticker() {
                    paths.attr("opacity", 0);
                    temp_int = 0;
                    show_ticker();
                    //tick = setTimeout(ticker, 4000 );
                })();
            }
        </script>
        
        
    </head>
    
    <body>
        <div id="container"></div>
        <div id="circle1"></div>
        
        <script type="text/javascript">
            if(!Detector.webgl) {
                Detector.addGetWebGLMessage();
            } else {
                var years = ['1990', '1995', '2000'];
                var container = document.getElementById('container');
                var globe = new DAT.Globe(container);
                var i, tweens = [];

                var settime = function(globe, t) {
                    return function() {
                        new TWEEN.Tween(globe).to({
                            time : t / years.length
                        }, 500).easing(TWEEN.Easing.Cubic.EaseOut).start();
                    }
                };

                var xhr;
                TWEEN.start();
                xhr = new XMLHttpRequest();
                xhr.open('GET', 't.json', true);
                xhr.onreadystatechange = function(e) {
                    if(xhr.readyState === 4) {
                        if(xhr.status === 200) {
                            var data = JSON.parse(xhr.responseText);
                            window.data = data;
                            globe.addData(data, {
                                format : 'magnitude',
                                name : '1990',
                                animated : true
                            });
                            
                            globe.createPoints();
                            settime(globe,0)();
                            globe.animate();
                        }
                    }
                };
                xhr.send(null);
            }
        </script>
        <script src="js/lib/kinetic-v4.3.1.js"></script>
        <script>
            var stage = new Kinetic.Stage({
                container: 'circle1',
                width: 1200,
                height: 960
            });
            
            var layer = new Kinetic.Layer();
            var paths = [],
                opacity = [];
            
            for(var n = 0; n < 24; n++) {
                var circle1 = new Kinetic.Wedge({
                    x: stage.getWidth() / 2,
                    y: stage.getHeight() / 2,
                    radius: 600,
                    angleDeg: 15,
                    fill: '#80f8eb',
                    stroke: '#80f8eb',
                    opacity: 0,
                    strokeWidth: 1,
                    rotationDeg: 15*n
                });
                
                paths.push(circle1);
                // add the shape to the layer
                layer.add(circle1);
                
                if(n < 6){
                    opacity[n] = 4 / 24 * n;
                    //console.info(opacity);
                }
            }
            
        
            // add the layer to the stage
            stage.add(layer);
            setInterval(start_alarm, 50);
            
            var now_path_num = 0,
                temp_num = 0;
                
            function start_alarm(){
                temp_num = now_path_num%24
                //console.info(paths[temp_num]);
                paths[temp_num].setOpacity(opacity[0]);
                if(temp_num + 1 >= 24){
                    paths[temp_num + 1 - 24].setOpacity(opacity[1]);
                }
                else{
                    paths[temp_num + 1].setOpacity(opacity[1]);
                }
                if(temp_num + 2 >= 24){
                    paths[temp_num + 2 - 24].setOpacity(opacity[2]);
                }
                else{
                    paths[temp_num + 2].setOpacity(opacity[2]);
                }
                if(temp_num + 3 >= 24){
                    paths[temp_num + 3 - 24].setOpacity(opacity[3]);
                }
                else{
                    paths[temp_num + 3].setOpacity(opacity[3]);
                }
                if(temp_num + 4 >= 24){
                    paths[temp_num + 4 - 24].setOpacity(opacity[4]);
                }
                else{
                    paths[temp_num + 4].setOpacity(opacity[4]);
                }
                if(temp_num + 5 >= 24){
                    paths[temp_num + 5 - 24].setOpacity(opacity[5]);
                }
                else{
                    paths[temp_num + 5].setOpacity(opacity[5]);
                }
                now_path_num += 1;
                
                layer.draw();
            }
            
            //为表格添加事件
            function scroll_table(alarm_data){
                time = (new Date()).toLocaleTimeString();
                
                var virus_name = alarm_data['5'];
                if(virus_name.length > 38){
                    virus_name = virus_name.substr(0, 35) + '...';
                }
                
                _tbodydom = $('#scrolltalbe tbody');
                _trdom = $('#scrolltalbe tbody tr');
                
                _trdom.eq(0).remove();
                
                _old = _tbodydom.html();
                
                _new = 
                    '<tr><td style="width: 45px"><div style="width: 5px">&nbsp;</div></td>'+
                        '<td style="width: 228px"><div style="width: 230px">' + virus_name + '</div></td>'+
                        '<td style="width: 135px"><div style="width: 110px">' + alarm_data['1'] + '</div></td></tr>';
                _tbodydom.html(_old + _new);
                
            };
            
            function addNode(cx, cy , layer) {
                
                var alarm_r5 = new Kinetic.Circle({
                    x : cx,
                    y : cy,
                    radius : 0,
                    fill:'#ff0000',
                    //stroke: '#ff0000',
                    opacity: 1,
                    //strokeWidth: 0,
                    draggable : true
                });
                
                layer.add(alarm_r5);
                

                alarm_r5.transitionTo({
                    radius: 20,
                    opacity: 0.0,
                    duration:1.5,
                    easing: 'ease-out',
                    //easing: 'ease-in',
                    callback: function() {
                        setTimeout(function(){alarm_r5.destroy()},1000);
                    }
                });
            };
            
            
            var now_flash_num = 0;
            setInterval(start_alarm_1, 500);
            
            function start_alarm_1(){
                //console.info(Math.floor(Math.random()*10));
                for(var w = 0; w < (Math.floor(Math.random()*10) + 5); w += 1){
                    addNode(alarm_data[now_flash_num][9], alarm_data[now_flash_num][10], layer);
                    scroll_table(alarm_data[now_flash_num]);
                    now_flash_num += 1;
                    if(now_flash_num == alarm_data.length){
                       now_flash_num = 0
                    }
                }
            }
            
        </script>
        
        <div id="login_div_2" class="login_div_2">
            <div id="text_div" class="text_div">Trojan/Win32.Powp.dey</div>
        </div>
        
        <div id="login_div_3" class="login_div_3"></div>
        
        <div id="table_div_1" class="table_div_1">
            <table id='scrolltalbe' class="table table-striped">
                <thead>
                    <tr>
                        <th style="width: 5px"></th>
                        <th style="width: 240px">恶意代码名称</th>
                        <th style="width: 110px">放马源地址</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>&nbsp;</td><td></td><td></td></tr>
                    <tr><td>&nbsp;</td><td></td><td></td></tr>
                    <tr><td>&nbsp;</td><td></td><td></td></tr>
                    <tr><td>&nbsp;</td><td></td><td></td></tr>
                    <tr><td>&nbsp;</td><td></td><td></td></tr>
                    <tr><td>&nbsp;</td><td></td><td></td></tr>
                </tbody>
            </table>
        </div>
        
    </body>
</html>