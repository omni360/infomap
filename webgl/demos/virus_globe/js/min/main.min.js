function u(e,t,n,r){e.path("M{0},{1},L{2},{3}L{4},{5}Z",t+1,n,t+13,n,t+7,n+10).attr({fill:r}),e.path("M{0},{1},L{2},{3}L{4},{5}Z",t-1,n,t-13,n,t-7,n+10).attr({fill:r}),e.path("M{0},{1},L{2},{3}L{4},{5}Z",t,n-1,t-6,n+11,t+6,n+11).attr({fill:r})}function a(e,t,n,r,i,s,o){var u=t,a=n-r/2,f=t+r*Math.cos(30*.017453293),l=n,c=f,h=l+r,p=t,d=n+r+r/2,v=t-r*Math.cos(30*.017453293),m=h,g=t-r*Math.cos(30*.017453293),y=n,b=(u+f)/2,w=(a+l)/2;e.path("M"+u+","+a+"L"+g+","+y+"L"+v+","+m+"L"+p+","+d+"L"+c+","+h+"L"+f+","+l+"z").attr({stroke:i,"stroke-width":2,"stroke-opacity":1}),r-=7,n+=3;var u=t,a=n-r/2,f=t+r*Math.cos(30*.017453293),l=n,c=f,h=l+r,p=t,d=n+r+r/2,v=t-r*Math.cos(30*.017453293),m=h,g=t-r*Math.cos(30*.017453293),y=n,b=u,w=(a+d)/2;e.path("M"+u+","+a+"L"+g+","+y+"L"+v+","+m+"L"+p+","+d+"L"+c+","+h+"L"+f+","+l+"z").attr({stroke:i,"stroke-width":4,"stroke-opacity":1}),e.text(b,w,s).attr({fill:o,"font-size":16,"font-weight":"bold","font-family":"微软雅黑"})}function f(e,t,n,r,i,s,o,u){i+=270,s+=270,a1=i%360*Math.PI/180,a2=s%360*Math.PI/180;var a=t+r*Math.cos(a1),f=n+r*Math.sin(a1),l=t+r*Math.cos(a2),c=n+r*Math.sin(a2);u==0?e.path("M"+a+" "+f+"A"+" "+r+" "+r+" 1 1 1 "+l+" "+c).attr({stroke:o,"stroke-width":1.5,"stroke-opacity":1,opacity:1}):e.path("M"+a+" "+f+"A"+" "+r+" "+r+" 0 0 1 "+l+" "+c).attr({stroke:o,"stroke-width":1.5,"stroke-opacity":1,opacity:1})}function l(e,t,n,r,i,s,o,u,a,f){s+=270,o+=270,a1=s%360*Math.PI/180,a2=o%360*Math.PI/180;var l=t+r*Math.cos(a2),c=n+r*Math.sin(a2),h=t+i*Math.cos(a1),p=n+i*Math.sin(a1),d=t+i*Math.cos(a2),v=n+i*Math.sin(a2);return e.path("M"+l+" "+c+"L"+d+" "+v).attr({stroke:u,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M"+f+" "+p+"L"+h+" "+p).attr({stroke:u,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),a==0?e.path("M"+h+" "+p+"A"+" "+i+" "+i+" 1 1 1 "+d+" "+v).attr({stroke:u,"stroke-width":1.5,"stroke-opacity":1,opacity:1}):e.path("M"+h+" "+p+"A"+" "+i+" "+i+" 0 0 1 "+d+" "+v).attr({stroke:u,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),p}function c(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){s+=270,u+=270,f+=270,c+=270,p+=270,v+=270,a1=s%360*Math.PI/180,a2=u%360*Math.PI/180,a3=f%360*Math.PI/180,a4=c%360*Math.PI/180,a5=p%360*Math.PI/180,a6=v%360*Math.PI/180;var y=t+r*Math.cos(a1),b=n+r*Math.sin(a1),w=t+r*Math.cos(a6),E=n+r*Math.sin(a6),S=t+i*Math.cos(a1),x=n+i*Math.sin(a1),T=t+o*Math.cos(a2),N=n+o*Math.sin(a2),C=t+a*Math.cos(a3),k=n+a*Math.sin(a3),L=t+l*Math.cos(a4),A=n+l*Math.sin(a4),O=t+h*Math.cos(a5),M=n+h*Math.sin(a5),_=t+d*Math.cos(a6),D=n+d*Math.sin(a6);e.path("M"+S+" "+x+"L"+T+" "+N+"L"+C+" "+k+"L"+L+" "+A+"L"+O+" "+M+"L"+_+" "+D+"L"+w+" "+E+"A"+" "+r+" "+r+" 0 0 0 "+y+" "+b+"z").attr({fill:m,"stroke-opacity":0,opacity:.8})}function h(e,t,n,r,i,s,o,u,a){var f=t,l=n+5,c=f-i,h=l+s,p=f+i,d=l+s,v=e.set();v.push(e.path("M"+f+","+l+"L"+c+","+h).attr({stroke:r,"stroke-width":2,"stroke-opacity":1})),v.push(e.path("M"+f+","+l+"L"+p+","+d).attr({stroke:r,"stroke-width":2,"stroke-opacity":1}));var m=(f+c)/2,g=(l+h)/2,y=(f+p)/2,b=(l+d)/2;v.push(e.path("M"+m+","+g+"L"+y+","+b).attr({stroke:r,"stroke-width":1,"stroke-opacity":1}));var w=(f+m)/2,E=(l+g)/2,S=(f+y)/2,x=(l+b)/2;v.push(e.path("M"+w+","+E+"L"+S+","+x).attr({stroke:r,"stroke-width":1,"stroke-opacity":1}));var T=(c+m)/2,N=(h+g)/2,C=(p+y)/2,k=(d+b)/2;v.push(e.path("M"+T+","+N+"L"+C+","+k).attr({stroke:r,"stroke-width":1,"stroke-opacity":1})),v.push(e.circle(t,n).attr({stroke:r,"stroke-width":2,r:5}).glow({color:r,opacity:.6}));var L=35,A=145,O=215,M=325,_=o,D=u,P=a;L+=270,A+=270,a1=L%360*Math.PI/180,a2=A%360*Math.PI/180,O+=270,M+=270,a3=O%360*Math.PI/180,a4=M%360*Math.PI/180;var H=t+_*Math.cos(a1),B=n+_*Math.sin(a1),j=t+_*Math.cos(a2),F=n+_*Math.sin(a2),I=t+D*Math.cos(a1),q=n+D*Math.sin(a1),R=t+D*Math.cos(a2),U=n+D*Math.sin(a2),z=t+P*Math.cos(a1),W=n+P*Math.sin(a1),X=t+P*Math.cos(a2),V=n+P*Math.sin(a2);v.push(e.path("M"+H+","+B+"A"+_+", "+_+", 0, 0, 1,"+j+","+F).attr({stroke:r,"stroke-width":1,"stroke-opacity":1})),v.push(e.path("M"+I+","+q+"A"+D+", "+D+", 0, 0, 1,"+R+","+U).attr({stroke:r,"stroke-width":1,"stroke-opacity":1})),v.push(e.path("M"+z+","+W+"A"+P+", "+P+", 0, 0, 1,"+X+","+V).attr({stroke:r,"stroke-width":1,"stroke-opacity":1}).glow({color:r,opacity:.6}));var $=t+_*Math.cos(a3),J=n+_*Math.sin(a3),K=t+_*Math.cos(a4),Q=n+_*Math.sin(a4),G=t+D*Math.cos(a3),Y=n+D*Math.sin(a3),Z=t+D*Math.cos(a4),et=n+D*Math.sin(a4),tt=t+P*Math.cos(a3),nt=n+P*Math.sin(a3),rt=t+P*Math.cos(a4),it=n+P*Math.sin(a4);return v.push(e.path("M"+$+","+J+"A"+_+", "+_+", 0, 0, 1,"+K+","+Q).attr({stroke:r,"stroke-width":1,"stroke-opacity":1})),v.push(e.path("M"+G+","+Y+"A"+D+", "+D+", 0, 0, 1,"+Z+","+et).attr({stroke:r,"stroke-width":1,"stroke-opacity":1})),v.push(e.path("M"+tt+","+nt+"A"+P+", "+P+", 0, 0, 1,"+rt+","+it).attr({stroke:r,"stroke-width":1,"stroke-opacity":1}).glow({color:r,opacity:.6})),v}function p(e,t,n,r,i,s){var o="#F6FAAA";s>10&&(s<50?o="#FFAE4E":s<100?o="#F46D43":s<1e3?o="#D53E4F":o="#9E0142"),e.rect(t,n,r,i,2).attr({"stroke-width":0,fill:o,"fill-opacity":1})}function d(e){var t=1,n=100;for(var r in e.countries){var i=e.countries[r];i.countryCode=r,i.countryName=ut[r];var s=i.lon-90,o=i.lat,u=Math.PI/2-o*Math.PI/180-Math.PI*.01,a=2*Math.PI-s*Math.PI/180+Math.PI*.06,f=new THREE.Vector3;f.x=Math.sin(u)*Math.cos(a)*n,f.y=Math.cos(u)*n,f.z=Math.sin(u)*Math.sin(a)*n,i.center=f,ot[i.countryName]=i}}function v(e){return ot[e.toUpperCase()]}function m(e){var t=document.getElementById("loading");for(var n in e){var r=e[n].data,i=e[n].t;at.push(i);var s=0;for(var o in r){var u=r[o],a=u.e.toUpperCase(),f=u.i.toUpperCase();exporter=ot[a],importer=ot[f];if(exporter===undefined||importer===undefined)continue;u.lineGeometry=E(exporter,importer,u.v,u.wc)}}t.style.display="none"}function g(e,t,n,r,i){for(var s in n)n[s]=n[s].toUpperCase();var o=parseInt(t)-1992;o>=it.length&&(o=it.length-1);var u=[],a=e[o].data,f=new THREE.Geometry,l=[],c=new THREE.Geometry,h=[];for(s in a){var p=a[s],d=p.e.toUpperCase(),v=p.i.toUpperCase(),m=$.inArray(d,n)>=0,g=$.inArray(v,n)>=0,y=m,b=g,w=ct[p.wc],E=m&&$.inArray(w,r)>=0,x=g&&$.inArray(w,i)>=0;if((b||y)&&(E||x)){if(p.lineGeometry===undefined)continue;var T=!1;d==yt.countryName&&(T=!0);var N=T?new THREE.Color(mt):new THREE.Color(gt),C;for(_ in p.lineGeometry.vertices){var k=p.lineGeometry.vertices[_];l.push(N),C=N}THREE.GeometryUtils.merge(f,p.lineGeometry);var L=C.clone(),A=p.lineGeometry.vertices,O=Math.floor(p.v/8e3/p.lineGeometry.vertices.length)+1;O=S(O,1,100),O=p.lineGeometry.vertices.length;var M=p.lineGeometry.size;for(var _=0;_<O;_++){var D=_/O*A.length,P=S(Math.floor(D),0,A.length-1),H=A[P],B=H.clone();B.moveIndex=P,B.nextIndex=P+1,B.nextIndex>=A.length&&(B.nextIndex=0),B.lerpN=0,B.path=A,c.vertices.push(B),B.size=M,h.push(L)}$.inArray(d,u)<0&&u.push(d),$.inArray(v,u)<0&&u.push(v);var j=p.v,F=ot[d];F.mapColor===undefined?F.mapColor=j:F.mapColor+=j;var I=ot[v];I.mapColor===undefined?I.mapColor=j:I.mapColor+=j,F.exportedAmount+=j,I.importedAmount+=j,F==yt&&(yt.summary.exported[p.wc]+=p.v,yt.summary.exported.total+=p.v),I==yt&&(yt.summary.imported[p.wc]+=p.v,yt.summary.imported.total+=p.v);if(I==yt||F==yt)yt.summary.total+=p.v}}f.colors=l;var q=new THREE.Line(f,new THREE.LineBasicMaterial({color:16777215,opacity:1,blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1,vertexColors:!0,linewidth:1}));q.renderDepth=!1,attributes={size:{type:"f",value:[]},customColor:{type:"c",value:[]}},uniforms={amplitude:{type:"f",value:1},color:{type:"c",value:new THREE.Color(16777215)},texture:{type:"t",value:0,texture:THREE.ImageUtils.loadTexture("images/map_mask.png")}};var R=new THREE.ShaderMaterial({uniforms:uniforms,attributes:attributes,vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,blending:THREE.AdditiveBlending,blendDst:THREE.SrcAlphaFactor,blendSrc:THREE.OneMinusSrcAlphaFactor,depthTest:!0,depthWrite:!1,transparent:!0}),U=THREE.ImageUtils.loadTexture("images/map_mask.png"),z=new THREE.ParticleBasicMaterial({map:U,color:16777215,size:60,blending:THREE.NormalBlending,transparent:!0,depthWrite:!1,vertexColors:!0,sizeAttenuation:!0});c.colors=h;var W=new THREE.ParticleSystem(c,R);W.dynamic=!0,q.add(W);var X=W.geometry.vertices,V=attributes.size.value,J=attributes.customColor.value;for(var k=0;k<X.length;k++)V[k]=W.geometry.vertices[k].size,J[k]=h[k];return W.update=function(){for(var e in this.geometry.vertices){var t=this.geometry.vertices[e],n=t.path,r=n.length;t.lerpN+=.05,t.lerpN>1&&(t.lerpN=0,t.moveIndex=t.nextIndex,t.nextIndex++,t.nextIndex>=n.length&&(t.moveIndex=0,t.nextIndex=1));var i=n[t.moveIndex],s=n[t.nextIndex];t.copy(i),t.lerpSelf(s,t.lerpN)}this.geometry.verticesNeedUpdate=!0},q.affectedCountries=u,q}function y(e,t,n,r,i){var s=n[0].toUpperCase();$("#hudButtons .countryTextInput").val(s),bt=yt,yt=ot[n[0].toUpperCase()],yt.summary={imported:{mil:0,civ:0,ammo:0,total:0},exported:{mil:0,civ:0,ammo:0,total:0},total:0,historical:Mt(yt)};for(var o in ot){var u=ot[o];u.exportedAmount=0,u.importedAmount=0,u.mapColor=0}for(var o in ft)_(ft[o]);while(nt.children.length>0){var a=nt.children[0];nt.remove(a)}var f=g(it,t,n,r,i);nt.add(f),f.affectedCountries.length==0&&f.affectedCountries.push(s);for(var o in f.affectedCountries)var l=f.affectedCountries[o],u=ot[l];Ot(f.affectedCountries);if(bt!==yt&&yt){rotateTargetX=yt.lat*Math.PI/180;var c=-(yt.lon-9)*Math.PI/180,h=0;for(;;){var p=c-Math.PI*2*h,d=c+Math.PI*2*h;if(Math.abs(p-tt.rotation.y)<Math.PI){rotateTargetY=p;break}if(Math.abs(d-tt.rotation.y)<Math.PI){rotateTargetY=d;break}h++,rotateTargetY=wrap(c,-Math.PI,Math.PI)}rotateVX*=.6,rotateVY*=.6}}function E(e,t,n,r){if(e.countryName==undefined||t.countryName==undefined)return undefined;var i=e.center.clone().subSelf(t.center).length(),s=b+i*.7,o=e.center,u=t.center,a=o.clone().lerpSelf(u,.5),f=a.length();a.normalize(),a.multiplyScalar(f+i*.7);var l=(new THREE.Vector3).sub(o,u);l.normalize();var c=i*.5,h=o,p=a.clone().addSelf(l.clone().multiplyScalar(c)),d=a.clone().addSelf(l.clone().multiplyScalar(-c)),v=u,m=new THREE.CubicBezierCurve3(o,h,p,a),g=new THREE.CubicBezierCurve3(a,d,v,u),y=Math.floor(i*.02+6)*2,E=m.getPoints(y);E=E.splice(0,E.length-1),E=E.concat(g.getPoints(y)),E.push(w);var x=n*20,T=10+Math.sqrt(x);T=S(T,.1,160);var N=THREE.Curve.Utils.createLineGeometry(E);return N.size=T,N}function S(e,t,n){return e<t?e=t:e>n&&(e=n),e}function N(){var e=new Tt;wt=e}function C(e){xhr=new XMLHttpRequest,xhr.open("GET",U,!0),xhr.onreadystatechange=function(){xhr.readyState===4&&xhr.status===200&&(st=JSON.parse(xhr.responseText),e&&e())},xhr.send(null)}function k(e){var t="categories/All.txt";t=encodeURI(t),xhr=new XMLHttpRequest,xhr.open("GET",t,!0),xhr.onreadystatechange=function(){xhr.readyState===4&&xhr.status===200&&(it=JSON.parse(xhr.responseText).timeBins,maxValue=0,startTime=it[0].t,endTime=it[it.length-1].t,timeLength=endTime-startTime,e&&e(),console.log("finished read data file"))},xhr.send(null)}function L(e){cxhr=new XMLHttpRequest,cxhr.open("GET",R,!0),cxhr.onreadystatechange=function(){cxhr.readyState===4&&cxhr.status===200&&(ut=JSON.parse(cxhr.responseText),console.log("loaded country codes"),e())},cxhr.send(null)}function O(e){var t=e.clientX-window.innerWidth*.5,n=e.clientY-window.innerHeight*.5,r=mouseX-t,i=mouseY-n,s=Math.sqrt(r*r+i*i)}function M(e,t){e=e.toUpperCase();var n=ot[e];if(n===undefined)return;var r=document.getElementById("visualization"),i=document.getElementById("marker_template"),s=i.cloneNode(!0);n.marker=s,r.appendChild(s),s.countryName=e,s.importance=t,s.selected=!1,s.hover=!1,e===yt.countryName.toUpperCase()&&(s.selected=!0),s.setPosition=function(e,t,n){this.style.left=e+"px",this.style.top=t+"px",this.style.zIndex=n},s.setVisible=function(e){e?this.style.display="inline":this.style.display="none"};var o=s.querySelector("#countryText");s.countryLayer=o;var u=s.querySelector("#detailText");s.detailLayer=u,s.jquery=$(s),s.setSize=function(e){var t=Math.floor(2+e*.5);this.detailLayer.style.fontSize=t+"pt";var n=t*2;this.style.fontSize=n*1.125+"pt",t<=8?this.countryLayer.style.marginTop="0px":this.countryLayer.style.marginTop="-1px"},s.update=function(){var e=tt.matrixWorld,t=e.multiplyVector3(n.center.clone()),r=screenXY(t),i=.3+z.scale.z*1,s=this.importance/5e6;s=S(s,0,18),i+=s,this.tiny&&(i*=.75),this.selected&&(i=30),this.hover&&(i=15),this.setSize(i),this.setVisible(t.z>60&&i>3);var o=Math.floor(1e3-t.z+i);if(this.selected||this.hover)o=1e4;this.setPosition(r.x,r.y,o)};var a=s.querySelector("#countryText"),f=t<2e7&&!s.selected;s.tiny=f,a.innerHTML=e.replace(" ","&nbsp;");var l="";n.exportedAmount>0&&n.importedAmount>0?l+="imported:&nbsp;$"+numberWithCommas(n.importedAmount)+"<br />"+"exported:&nbsp;$"+numberWithCommas(n.exportedAmount):n.exportedAmount>0&&n.importedAmount==0?l+="exported:&nbsp;$"+numberWithCommas(n.exportedAmount)+"<br />&nbsp;":n.exportedAmount==0&&n.importedAmount>0&&(l+="imported:&nbsp;$"+numberWithCommas(n.importedAmount)+"<br />&nbsp;"),s.importExportText=l;var c=function(e){this.detailLayer.innerHTML=l,this.hover=!0},h=function(e){this.detailLayer.innerHTML="",this.hover=!1};f?(s.addEventListener("mouseover",c,!1),s.addEventListener("mouseout",h,!1)):u.innerHTML=l;var p=function(e){var t=wt;y(it,t.selectedYear,[this.countryName],t.getExportCategories(),t.getImportCategories())};s.addEventListener("click",p,!0),A.push(s)}function _(e){e=e.toUpperCase();var t=ot[e];if(t===undefined)return;if(t.marker===undefined)return;var n=A.indexOf(t.marker);n>=0&&A.splice(n,1);var r=document.getElementById("visualization");r.removeChild(t.marker),t.marker=undefined}function xt(e){Detector.webgl?(F=new Image,F.src="images/map_indexed.png",F.onload=function(){I=new Image,I.src="images/map_outline.png",I.onload=function(){L(function(){C(function(){k(function(){Nt(),Ct()})})})}}):Detector.addGetWebGLMessage()}function Nt(){W=new THREE.Scene,W.matrixAutoUpdate=!1,W.add(new THREE.AmbientLight(5263440)),light1=new THREE.SpotLight(15658734,3),light1.position.x=730,light1.position.y=520,light1.position.z=626,light1.castShadow=!0,W.add(light1),light2=new THREE.PointLight(2236962,14.8),light2.position.x=-640,light2.position.y=-500,light2.position.z=-1e3,W.add(light2),tt=new THREE.Object3D,W.add(tt),Q=document.createElement("canvas"),Q.width=256,Q.height=1,G=new THREE.Texture(Q),G.magFilter=THREE.NearestFilter,G.minFilter=THREE.NearestFilter,G.needsUpdate=!0;var e=new THREE.Texture(F);e.needsUpdate=!0,e.magFilter=THREE.NearestFilter,e.minFilter=THREE.NearestFilter;var t=new THREE.Texture(I);t.needsUpdate=!0;var n={mapIndex:{type:"t",value:0,texture:e},lookup:{type:"t",value:1,texture:G},outline:{type:"t",value:2,texture:t},outlineLevel:{type:"f",value:1}};rt=n;var r=new THREE.ShaderMaterial({uniforms:n,vertexShader:document.getElementById("globeVertexShader").textContent,fragmentShader:document.getElementById("globeFragmentShader").textContent});backMat=new THREE.MeshBasicMaterial({}),et=new THREE.Mesh(new THREE.SphereGeometry(100,40,40),r),et.doubleSided=!1,et.rotation.x=Math.PI,et.rotation.y=-Math.PI/2,et.rotation.z=Math.PI,et.id="base",tt.add(et);var i={earth:{uniforms:{texture:{type:"t",value:0,texture:null}},vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec3 vNormal;","varying vec2 vUv;","void main() {","vec3 diffuse = texture2D( texture, vUv ).xyz;","float intensity = 1.05 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) );","vec3 atmosphere = vec3( 1.0, 1.0, 1.0 ) * pow( intensity, 3.0 );","gl_FragColor = vec4( diffuse + atmosphere, 1.0 );","}"].join("\n")},atmosphere:{uniforms:{},vertexShader:["varying vec3 vNormal;","void main() {","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","void main() {","float intensity = pow( 0.8 - dot( vNormal, vec3( 0, 0, 1.0 ) ), 12.0 );","gl_FragColor = vec4( 1.0, 1.0, 1.0, 0.6 ) * intensity;","}"].join("\n")}},s=new THREE.Scene,o=i.atmosphere,n=THREE.UniformsUtils.clone(o.uniforms),u=new THREE.ShaderMaterial({uniforms:n,vertexShader:o.vertexShader,fragmentShader:o.fragmentShader}),a=new THREE.Mesh(new THREE.SphereGeometry(100,40,40),u);a.scale.x=a.scale.y=a.scale.z=1.05,a.flipSided=!0,a.matrixAutoUpdate=!1,a.updateMatrix(),tt.add(a);for(var f in it){var l=it[f].data;for(var c in l){var h=l[c],p=h.e.toUpperCase(),v=h.i.toUpperCase();$.inArray(p,ft)<0&&ft.push(p),$.inArray(v,ft)<0&&ft.push(v)}}d(st);var g=m(it);nt=new THREE.Object3D,tt.add(nt),N(),wt.selectedYear="1996",wt.selectedCountry="China",y(it,"1996",["China"],[],["Military Weapons","Civilian Weapons","Ammunition"]),X=new THREE.WebGLRenderer({antialias:!1}),X.setSize(window.innerWidth,window.innerHeight),X.autoClear=!1,X.sortObjects=!1,X.generateMipmaps=!1,q.appendChild(X.domElement),document.addEventListener("mousemove",onDocumentMouseMove,!0),document.addEventListener("windowResize",onDocumentResize,!1),B.addEventListener("mousedown",onDocumentMouseDown,!0),B.addEventListener("mouseup",onDocumentMouseUp,!1),B.addEventListener("click",onClick,!0),B.addEventListener("mousewheel",onMouseWheel,!1),B.addEventListener("DOMMouseScroll",function(e){var t=window.event||e;onMouseWheel(t)},!1),document.addEventListener("keydown",onKeyDown,!1),z=new THREE.PerspectiveCamera(12,window.innerWidth/window.innerHeight,1,2e4),z.position.z=300,z.position.y=0,z.lookAt(W.width/2,W.height/2),W.add(z);var b=THREEx.WindowResize(X,z)}function Ct(){D&&(z.position.z<1600?z.position.z=z.position.z+12:D=!1),rotateTargetX!==undefined&&rotateTargetY!==undefined&&(rotateVX+=(rotateTargetX-rotateX)*.012,rotateVY+=(rotateTargetY-rotateY)*.012,Math.abs(rotateTargetX-rotateX)<.1&&Math.abs(rotateTargetY-rotateY)<-0.1&&(rotateTargetX=undefined,rotateTargetY=undefined)),rotateX+=rotateVX,rotateY+=rotateVY,rotateVX*=.98,rotateVY*=.98;if(dragging||rotateTargetX!==undefined)rotateVX*=.6,rotateVY*=.6;rotateY+=T.spin*.01,rotateX<-rotateXMax&&(rotateX=-rotateXMax,rotateVX*=-0.95),rotateX>rotateXMax&&(rotateX=rotateXMax,rotateVX*=-0.95),TWEEN.update(),tt.rotation.x=rotateX,tt.rotation.y=rotateY,kt(),requestAnimationFrame(Ct),THREE.SceneUtils.traverseHierarchy(tt,function(e){e.update!==undefined&&e.update()});for(var e in A){var t=A[e];t.update()}}function kt(){X.clear(),X.render(W,z)}function Lt(e){e=e.toUpperCase();for(var t in ut)if(ut[t]===e)return t;return"not found"}function Ot(e){var t=[];for(var n in e){var r=Lt(e[n]);t.push(r)}var i=Q.getContext("2d");i.clearRect(0,0,256,1);var s=e.length==0?0:1,o=10*s;i.fillStyle="rgb("+o+","+o+","+o+")",i.fillRect(0,0,1,1);var u=yt.countryCode;for(var n in t){var a=t[n],f=At[a],l=ot[e[n]].mapColor,c="#333333";a===u&&(c="#eeeeee"),i.fillStyle=c,i.fillRect(f,0,1,1)}G.needsUpdate=!0}function Mt(e){var t=[],n=e.countryName,r=wt.getExportCategories(),i=wt.getImportCategories();for(var s in it){var o=it[s].data,u={imports:0,exports:0};for(var a in o){var f=o[a],l=ct[f.wc],c=f.e.toUpperCase(),h=f.i.toUpperCase(),p=n==c&&$.inArray(l,r)>=0||n==h&&$.inArray(l,i)>=0;if(p==0)continue;if(ot[c]===undefined||ot[h]===undefined)continue;c==n&&(u.exports+=f.v),h==n&&(u.imports+=f.v)}t.push(u)}return t}function _t(){var e=undefined;nt.children[0]!==undefined&&(e=nt.children[0].affectedCountries),Ot([]),tt.remove(nt),rt.outlineLevel.value=0,G.needsUpdate=!0,X.autoClear=!1,X.autoClearColor=!1,X.autoClearDepth=!1,X.autoClearStencil=!1,X.preserve,X.clear(),X.render(W,z);var t=X.context;t.preserveDrawingBuffer=!0;var n=mouseX+X.context.canvas.width/2,r=-mouseY+X.context.canvas.height/2;n=Math.floor(n),r=Math.floor(r);var i=new Uint8Array(4);return t.readPixels(n,r,1,1,t.RGBA,t.UNSIGNED_BYTE,i),X.autoClear=!0,X.autoClearColor=!0,X.autoClearDepth=!0,X.autoClearStencil=!0,t.preserveDrawingBuffer=!1,rt.outlineLevel.value=1,tt.add(nt),e!==undefined&&Ot(e),i[0]}var e=[{i:"CHINA",wc:"mil",e:"UNITED STATES",v:"4307"},{i:"CHINA",wc:"mil",e:"THAILAND",v:"26"},{i:"CHINA",wc:"mil",e:"KOREA REPUBLIC OF",v:"152"},{i:"CHINA",wc:"mil",e:"LUXEMBOURG",v:"6"},{i:"CHINA",wc:"mil",e:"CANADA",v:"167"},{i:"CHINA",wc:"mil",e:"MEXICO",v:"36"},{i:"CHINA",wc:"mil",e:"GERMANY",v:"1015"},{i:"CHINA",wc:"mil",e:"JAPAN",v:"103"},{i:"CHINA",wc:"mil",e:"SWEDEN",v:"139"},{i:"CHINA",wc:"mil",e:"BULGARIA",v:"11"},{i:"CHINA",wc:"mil",e:"UKRAINE",v:"93"},{i:"CHINA",wc:"mil",e:"FRANCE",v:"43"},{i:"CHINA",wc:"mil",e:"NETHERLANDS",v:"24"},{i:"CHINA",wc:"mil",e:"RUSSIAN FEDERATION",v:"174"},{i:"CHINA",wc:"mil",e:"SINGAPORE",v:"60"},{i:"CHINA",wc:"mil",e:"CZECH REPUBLIC",v:"38"},{i:"CHINA",wc:"mil",e:"UNITED KINGDOM",v:"47"},{i:"CHINA",wc:"mil",e:"COLOMBIA",v:"11"},{i:"CHINA",wc:"mil",e:"ITALY",v:"35"},{i:"CHINA",wc:"mil",e:"BRAZIL",v:"17"}],t=[{i:"CHINA",wc:"mil",e:"UNITED STATES",v:"2869"},{i:"CHINA",wc:"mil",e:"THAILAND",v:"109"},{i:"CHINA",wc:"mil",e:"KOREA REPUBLIC OF",v:"92"},{i:"CHINA",wc:"mil",e:"LUXEMBOURG",v:"3"},{i:"CHINA",wc:"mil",e:"CANADA",v:"108"},{i:"CHINA",wc:"mil",e:"MEXICO",v:"9"},{i:"CHINA",wc:"mil",e:"GERMANY",v:"341"},{i:"CHINA",wc:"mil",e:"JAPAN",v:"117"},{i:"CHINA",wc:"mil",e:"SWEDEN",v:"17"},{i:"CHINA",wc:"mil",e:"BULGARIA",v:"3"},{i:"CHINA",wc:"mil",e:"UKRAINE",v:"46"},{i:"CHINA",wc:"mil",e:"FRANCE",v:"25"},{i:"CHINA",wc:"mil",e:"NETHERLANDS",v:"10"},{i:"CHINA",wc:"mil",e:"RUSSIAN FEDERATION",v:"284"},{i:"CHINA",wc:"mil",e:"SINGAPORE",v:"17"},{i:"CHINA",wc:"mil",e:"CZECH REPUBLIC",v:"7"},{i:"CHINA",wc:"mil",e:"UNITED KINGDOM",v:"35"},{i:"CHINA",wc:"mil",e:"COLOMBIA",v:"5"},{i:"CHINA",wc:"mil",e:"INDIA",v:"410"},{i:"CHINA",wc:"mil",e:"BRAZIL",v:"13"}],n=[{i:"CHINA",wc:"mil",e:"UNITED STATES",v:"2422"},{i:"CHINA",wc:"mil",e:"THAILAND",v:"138"},{i:"CHINA",wc:"mil",e:"KOREA REPUBLIC OF",v:"102"},{i:"CHINA",wc:"mil",e:"LUXEMBOURG",v:"11"},{i:"CHINA",wc:"mil",e:"CANADA",v:"105"},{i:"CHINA",wc:"mil",e:"MEXICO",v:"37"},{i:"CHINA",wc:"mil",e:"GERMANY",v:"208"},{i:"CHINA",wc:"mil",e:"JAPAN",v:"117"},{i:"CHINA",wc:"mil",e:"SWEDEN",v:"22"},{i:"CHINA",wc:"mil",e:"BULGARIA",v:"33"},{i:"CHINA",wc:"mil",e:"UKRAINE",v:"185"},{i:"CHINA",wc:"mil",e:"FRANCE",v:"13"},{i:"CHINA",wc:"mil",e:"NETHERLANDS",v:"24"},{i:"CHINA",wc:"mil",e:"RUSSIAN FEDERATION",v:"205"},{i:"CHINA",wc:"mil",e:"SINGAPORE",v:"24"},{i:"CHINA",wc:"mil",e:"CZECH REPUBLIC",v:"13"},{i:"CHINA",wc:"mil",e:"UNITED KINGDOM",v:"27"},{i:"CHINA",wc:"mil",e:"COLOMBIA",v:"4"},{i:"CHINA",wc:"mil",e:"ITALY",v:"17"},{i:"CHINA",wc:"mil",e:"BRAZIL",v:"47"}],r=[{i:"CHINA",wc:"mil",e:"UNITED STATES",v:"19586"},{i:"CHINA",wc:"mil",e:"THAILAND",v:"2"},{i:"CHINA",wc:"mil",e:"KOREA REPUBLIC OF",v:"6966"},{i:"CHINA",wc:"mil",e:"LUXEMBOURG",v:"2886"},{i:"CHINA",wc:"mil",e:"CANADA",v:"153"},{i:"CHINA",wc:"mil",e:"MEXICO",v:"118"},{i:"CHINA",wc:"mil",e:"GERMANY",v:"308"},{i:"CHINA",wc:"mil",e:"JAPAN",v:"427"},{i:"CHINA",wc:"mil",e:"SWEDEN",v:"291"},{i:"CHINA",wc:"mil",e:"BULGARIA",v:"87"},{i:"CHINA",wc:"mil",e:"UKRAINE",v:"104"},{i:"CHINA",wc:"mil",e:"FRANCE",v:"69"},{i:"CHINA",wc:"mil",e:"NETHERLANDS",v:"266"},{i:"CHINA",wc:"mil",e:"RUSSIAN FEDERATION",v:"550"},{i:"CHINA",wc:"mil",e:"SINGAPORE",v:"21"},{i:"CHINA",wc:"mil",e:"CZECH REPUBLIC",v:"757"},{i:"CHINA",wc:"mil",e:"UNITED KINGDOM",v:"287"},{i:"CHINA",wc:"mil",e:"COLOMBIA",v:"133"},{i:"CHINA",wc:"mil",e:"ITALY",v:"87"},{i:"CHINA",wc:"mil",e:"BRAZIL",v:"16"}],i=[{i:"CHINA",wc:"mil",e:"UNITED STATES",v:"6725"},{i:"CHINA",wc:"mil",e:"THAILAND",v:"2120"},{i:"CHINA",wc:"mil",e:"KOREA REPUBLIC OF",v:"3751"},{i:"CHINA",wc:"mil",e:"LUXEMBOURG",v:"3405"},{i:"CHINA",wc:"mil",e:"CANADA",v:"312"},{i:"CHINA",wc:"mil",e:"MEXICO",v:"517"},{i:"CHINA",wc:"mil",e:"GERMANY",v:"870"},{i:"CHINA",wc:"mil",e:"JAPAN",v:"238"},{i:"CHINA",wc:"mil",e:"SWEDEN",v:"824"},{i:"CHINA",wc:"mil",e:"BULGARIA",v:"46"},{i:"CHINA",wc:"mil",e:"UKRAINE",v:"327"},{i:"CHINA",wc:"mil",e:"FRANCE",v:"87"},{i:"CHINA",wc:"mil",e:"NETHERLANDS",v:"1767"},{i:"CHINA",wc:"mil",e:"RUSSIAN FEDERATION",v:"188"},{i:"CHINA",wc:"mil",e:"SINGAPORE",v:"8"},{i:"CHINA",wc:"mil",e:"CZECH REPUBLIC",v:"6499"},{i:"CHINA",wc:"mil",e:"UNITED KINGDOM",v:"144"},{i:"CHINA",wc:"mil",e:"COLOMBIA",v:"256"},{i:"CHINA",wc:"mil",e:"ITALY",v:"43"},{i:"CHINA",wc:"mil",e:"BRAZIL",v:"14"}],s=[{i:"CHINA",wc:"mil",e:"美国",v:"6951"},{i:"CHINA",wc:"mil",e:"泰国",v:"4291"},{i:"CHINA",wc:"mil",e:"韩国",v:"1629"},{i:"CHINA",wc:"mil",e:"卢森堡",v:"1557"},{i:"CHINA",wc:"mil",e:"加拿大",v:"463"},{i:"CHINA",wc:"mil",e:"墨西哥",v:"390"},{i:"CHINA",wc:"mil",e:"德国",v:"299"},{i:"CHINA",wc:"mil",e:"日本",v:"273"},{i:"CHINA",wc:"mil",e:"瑞典",v:"263"},{i:"CHINA",wc:"mil",e:"保加利亚",v:"189"},{i:"CHINA",wc:"mil",e:"乌克兰",v:"178"},{i:"CHINA",wc:"mil",e:"法国",v:"109"},{i:"CHINA",wc:"mil",e:"荷兰",v:"99"},{i:"CHINA",wc:"mil",e:"俄罗斯",v:"68"},{i:"CHINA",wc:"mil",e:"新加坡",v:"60"},{i:"CHINA",wc:"mil",e:"捷克",v:"57"},{i:"CHINA",wc:"mil",e:"英国",v:"43"},{i:"CHINA",wc:"mil",e:"哥伦比亚",v:"41"},{i:"CHINA",wc:"mil",e:"意大利",v:"37"},{i:"CHINA",wc:"mil",e:"巴西",v:"30"}],o=[{dev_num:37,pro_dev_perhour:27664329,province:"hebei",name:"冀"},{dev_num:34,pro_dev_perhour:40038613,province:"shanxi",name:"晋"},{dev_num:26,pro_dev_perhour:32072696,province:"liaoning",name:"辽"},{dev_num:27,pro_dev_perhour:27452391,province:"jilin",name:"吉"},{dev_num:36,pro_dev_perhour:24647105,province:"heilongjiang",name:"黑"},{dev_num:15,pro_dev_perhour:3471589,province:"jiangsu",name:"苏"},{dev_num:102,pro_dev_perhour:10832309,province:"zhejiang",name:"浙"},{dev_num:36,pro_dev_perhour:41768892,province:"anhui",name:"皖"},{dev_num:40,pro_dev_perhour:42631472,province:"fujian",name:"闽"},{dev_num:35,pro_dev_perhour:9,province:"jiangxi",name:"赣"},{dev_num:48,pro_dev_perhour:19249270,province:"shandong",name:"鲁"},{dev_num:36,pro_dev_perhour:13781567,province:"henan",name:"豫"},{dev_num:50,pro_dev_perhour:56035089,province:"hubei",name:"鄂"},{dev_num:43,pro_dev_perhour:19509497,province:"hunan",name:"湘"},{dev_num:110,pro_dev_perhour:35382393,province:"guangdong",name:"粤"},{dev_num:15,pro_dev_perhour:8738396,province:"hainan",name:"琼"},{dev_num:55,pro_dev_perhour:25357558,province:"sichuan",name:"川"},{dev_num:22,pro_dev_perhour:24853473,province:"guizhou",name:"黔"},{dev_num:28,pro_dev_perhour:10885016,province:"yunnan",name:"滇"},{dev_num:22,pro_dev_perhour:16187040,province:"gansu",name:"甘"},{dev_num:20,pro_dev_perhour:17734883,province:"qinghai",name:"青"},{dev_num:74,pro_dev_perhour:64,province:"shaanxi",name:"陕"},{dev_num:65,pro_dev_perhour:19879114,province:"beifen",name:"京"},{dev_num:25,pro_dev_perhour:14658726,province:"tianjin",name:"津"},{dev_num:57,pro_dev_perhour:37109001,province:"shanghai",name:"沪"},{dev_num:39,pro_dev_perhour:38177241,province:"chongqing",name:"渝"},{dev_num:29,pro_dev_perhour:22489170,province:"neimenggu",name:"蒙"},{dev_num:26,pro_dev_perhour:7,province:"guangxi",name:"桂"},{dev_num:4,pro_dev_perhour:9354830,province:"xizang",name:"藏"},{dev_num:17,pro_dev_perhour:4105183,province:"ningxia",name:"宁"},{dev_num:110,pro_dev_perhour:90301296,province:"xinjiang",name:"新"}];Raphael("raphael_div",1900,1060,function(){var e=this,t=1900,n=1060,r;for(var i=0;i<800;i++){var s=Math.random()*t,o=Math.random()*n;Math.random()>.7?r=2:r=1,e.circle(s,o,r).attr({fill:"#E7F9FD","stroke-width":0,opacity:.8})}}),Raphael(70,180,480,750,function(){var e=this,t=480,n=750;e.rect(0,0,t,n,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":.1,stroke:"#ffffff"}),e.rect(0,33,t,3,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(0,40,t,1,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(22,8,1,20,0).attr({"stroke-width":0,fill:"#31474E","fill-opacity":1}),e.text(35,17,"数据总揽").attr({fill:"#C3CFD1","font-size":15,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(30,50,200,200,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":.15}),a(e,130,120,60,"#C4D2D5","中国","#C4D2D5"),e.rect(260,80,130,1,0).attr({"stroke-width":0,fill:"#13748D","fill-opacity":1}),e.text(265,70,"URL总数  : 1,234,787").attr({fill:"#80DCEA","font-size":12,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(310,120,130,1,0).attr({"stroke-width":0,fill:"#13748D","fill-opacity":1}),e.text(315,110,"恶意代码检出数  : 9,522").attr({fill:"#80DCEA","font-size":12,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(260,160,130,1,0).attr({"stroke-width":0,fill:"#13748D","fill-opacity":1}),e.text(265,150,"探针数  : 1,014").attr({fill:"#80DCEA","font-size":12,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(310,200,130,1,0).attr({"stroke-width":0,fill:"#13748D","fill-opacity":1}),e.text(315,190,"源地址  : 38,967").attr({fill:"#80DCEA","font-size":12,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(260,240,130,1,0).attr({"stroke-width":0,fill:"#13748D","fill-opacity":1}),e.text(265,230,"目标地址  : 34,754").attr({fill:"#80DCEA","font-size":12,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(0,300,t,3,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(0,307,t,1,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(22,275,1,20,0).attr({"stroke-width":0,fill:"#31474E","fill-opacity":1}),e.text(35,284,"高危域名").attr({fill:"#C3CFD1","font-size":15,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"});var r="#E11668",i=130,s=440,u=20,h=2*Math.PI/u,p=0,d=360/u;e.circle(i,s,35).attr({fill:r,"stroke-width":0,opacity:1}),e.text(130,440,"高危域名").attr({fill:"#FFFFFF","font-size":12,"font-weight":"bold","font-family":"微软雅黑"});var v=[1,2,3,4,5,6,7,9,10,11,13,14,15,17,18,20,22,25,29,30];for(var m=0;m<u;m++){var g=h*m-Math.PI/2,y=Math.cos(g),b=Math.sin(g);p+=d,r3=55,m==0?e.text(i+r3*y,s+r3*b,v[m]).attr({fill:"#ffffff","font-size":7}):e.text(i+r3*y,s+r3*b,v[m]).attr({fill:"#ffffff","font-size":7}).transform("r"+p)}f(e,i,s,65,210,330,r,1);var w=l(e,i,s,65,110,90,210,r,1,290);e.path("M290 "+w+"L"+310+" "+(w-90)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M310 "+(w-90)+"L"+340+" "+(w-90)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.text(350,w-90,"xasrc.ctfs.ftn.qq.com").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","text-anchor":"start"});var w=l(e,i,s,65,113,92,225,r,1,290);e.path("M290 "+w+"L"+310+" "+(w-60)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M310 "+(w-60)+"L"+340+" "+(w-60)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.text(350,w-60,"download.cpudln.com").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","text-anchor":"start"});var w=l(e,i,s,65,116,94,260,r,1,290);e.path("M290 "+w+"L"+310+" "+(w-30)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M310 "+(w-30)+"L"+340+" "+(w-30)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.text(350,w-30,"webdiskdtj.store.qq.com").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","text-anchor":"start"});var w=l(e,i,s,65,119,96,290,r,0,290);e.path("M290 "+w+"L"+310+" "+(w+10)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M310 "+(w+10)+"L"+340+" "+(w+10)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.text(350,w+10,"znwt.jz5u.com").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","text-anchor":"start"});var w=l(e,i,s,65,122,98,310,r,0,290);e.path("M290 "+w+"L"+310+" "+(w+30)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M310 "+(w+30)+"L"+340+" "+(w+30)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.text(350,w+30,"down.zhuoku.com").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","text-anchor":"start"});var w=l(e,i,s,65,125,100,330,r,0,290);e.path("M290 "+w+"L"+310+" "+(w+60)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.path("M310 "+(w+60)+"L"+340+" "+(w+60)).attr({stroke:r,"stroke-width":1.5,"stroke-opacity":1,opacity:1}),e.text(350,w+60,"dl.airplayme.com").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","text-anchor":"start"}),c(e,i,s,65,70,210,88,225,99,260,97,290,86,310,80,330,r,0),e.rect(0,623,t,3,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(0,630,t,1,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(22,598,1,20,0).attr({"stroke-width":0,fill:"#31474E","fill-opacity":1}),e.text(35,607,"各省探针流量排行").attr({fill:"#C3CFD1","font-size":15,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"});var E=0,S=0,T=0,N=0;for(x in o)monitor_data=o[x],E=monitor_data.dev_num,T=monitor_data.pro_dev_perhour,E>S&&(S=E),T>N&&(N=T);var C=30,k=650,L=0,A=660,O=0;for(x in o)L=o[x].pro_dev_perhour/N*70
,L>70&&(L=70),L<1&&(L=1),e.rect(C,k+(70-L),10,L,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.text(C,732,o[x].name).attr({fill:"#C3CFD1","font-size":8,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),O=o[x].dev_num/S*20,e.rect(C,A-O,10,3,0).attr({"stroke-width":0,fill:"#E11668","fill-opacity":1}),C+=12;e.rect(420,660,45,5,0).attr({"stroke-width":0,fill:"#E11668","fill-opacity":1}),e.text(420,675,"探针数量").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),e.rect(420,700,45,5,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.text(420,715,"捕获流量").attr({fill:"#C3CFD1","font-size":10,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"})}),Raphael(660,890,700,100,function(){function h(){H?f.hide():f.show(),H=!H,b()}function m(){P?p.hide():p.show(),P=!P,b()}function g(e){e!=n&&(t.attr({cx:100*e,cy:52}),n=e)}function b(){var e=[],t=[];H&&(e=["Military Weapons","Civilian Weapons","Ammunition"]),P&&(t=["Military Weapons","Civilian Weapons","Ammunition"]),wt.selectedYear=r,y(it,r,[wt.selectedCountry],e,t)}var e=this;e.rect(0,0,700,100,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":.1}),e.rect(40,40,520,3,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),e.rect(40,60,520,3,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1});var t=e.circle(500,52).attr({r:9,fill:"#E5E5E5",opacity:1,stroke:"#ff0000","stroke-width":0}),n=5,r="1996";e.circle(100,52).attr({r:5,fill:"#25C3FD",opacity:1,stroke:"#ff0000","stroke-width":0});var i=e.circle(100,52).attr({r:16,fill:"#13748D",opacity:0,stroke:"#ff0000","stroke-width":0});i.click(function(){g(1),r="1992",b()}),e.text(100,75,"2012/10").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"}),e.circle(200,52).attr({r:5,fill:"#25C3FD",opacity:1,stroke:"#ff0000","stroke-width":0});var s=e.circle(200,52).attr({r:16,fill:"#13748D",opacity:0,stroke:"#ff0000","stroke-width":0});s.click(function(){g(2),r="1993",b()}),e.text(200,75,"2012/11").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"}),e.circle(300,52).attr({r:5,fill:"#25C3FD",opacity:1,stroke:"#ff0000","stroke-width":0});var o=e.circle(300,52).attr({r:16,fill:"#13748D",opacity:0,stroke:"#ff0000","stroke-width":0});o.click(function(){g(3),r="1994",b()}),e.text(300,75,"2012/12").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"}),e.circle(400,52).attr({r:5,fill:"#25C3FD",opacity:1,stroke:"#ff0000","stroke-width":0});var u=e.circle(400,52).attr({r:16,fill:"#13748D",opacity:0,stroke:"#ff0000","stroke-width":0});u.click(function(){g(4),r="1995",b()}),e.text(400,75,"2013/1").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"}),e.circle(500,52).attr({r:5,fill:"#25C3FD",opacity:1,stroke:"#ff0000","stroke-width":0});var a=e.circle(500,52).attr({r:16,fill:"#13748D",opacity:0,stroke:"#ff0000","stroke-width":0});a.click(function(){g(5),r="1996",b()}),e.text(500,75,"2013/2").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"});var f=e.rect(600,20,60,30,4).attr({"stroke-width":6,stroke:"#E5E5E5","fill-opacity":0}),l=e.rect(600,20,60,30,4).attr({"stroke-width":0,fill:"#2B8AFF","fill-opacity":1}),c=e.text(630,35,"源").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"});c.click(h),l.click(h),f.hide();var p=e.rect(600,55,60,30,4).attr({"stroke-width":6,stroke:"#E5E5E5","fill-opacity":0}),d=e.rect(600,55,60,30,4).attr({"stroke-width":0,fill:"#FF6114","fill-opacity":1}),v=e.text(630,70,"目标").attr({fill:"#FAFAFA","font-size":12,"font-weight":"bold","font-family":"微软雅黑"});v.click(m),d.click(m)}),Raphael(1400,180,360,750,function(){var o=this,u=360,a=750;o.rect(0,0,u,a,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":.1,stroke:"#ffffff"}),o.rect(0,33,u,3,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(0,40,u,1,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(22,8,1,20,0).attr({"stroke-width":0,fill:"#31474E","fill-opacity":1}),o.text(35,17,"高危国家感染趋势").attr({fill:"#C3CFD1","font-size":15,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),o.rect(48,75,76,2,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(48,75,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(86,70,2,15,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(124,75,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(86,60,"感染源").attr({fill:"#25C3FD","font-size":12,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(172,75,76,2,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(172,75,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(210,70,2,15,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(248,75,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(210,60,"感染目标").attr({fill:"#25C3FD","font-size":12,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(30,670,300,2,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.rect(48,660,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(48,680,"2012/12").attr({fill:"#25C3FD","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(86,660,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(86,680,"2013/1").attr({fill:"#25C3FD","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(124,660,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(124,680,"2013/2").attr({fill:"#25C3FD","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(172,660,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(172,680,"2012/12").attr({fill:"#25C3FD","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(210,660,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(210,680,"2013/1").attr({fill:"#25C3FD","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(248,660,2,10,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(248,680,"2013/2").attr({fill:"#25C3FD","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(330,655,2,17,0).attr({"stroke-width":0,fill:"#25C3FD","fill-opacity":1}),o.text(330,680,"国家").attr({fill:"#25C3FD","font-size":10,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(30,710,50,15,0).attr({"stroke-width":0,fill:"#F6FAAA","fill-opacity":1}),o.text(30,732,"0").attr({fill:"#C3CFD1","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(80,710,50,15,0).attr({"stroke-width":0,fill:"#FFAE4E","fill-opacity":1}),o.text(80,732,"10").attr({fill:"#C3CFD1","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(130,710,50,15,0).attr({"stroke-width":0,fill:"#F46D43","fill-opacity":1}),o.text(130,732,"50").attr({fill:"#C3CFD1","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(180,710,50,15,0).attr({"stroke-width":0,fill:"#D53E4F","fill-opacity":1}),o.text(180,732,"100").attr({fill:"#C3CFD1","font-size":8,"font-weight":"bold","font-family":"微软雅黑"}),o.rect(230,710,50,15,0).attr({"stroke-width":0,fill:"#9E0142","fill-opacity":1}),o.text(230,732,"1000").attr({fill:"#C3CFD1","font-size":8,"font-weight":"bold","font-family":"微软雅黑"});var f=30,l=90,c=36,h=26;for(x in e)monitor_data=e[x],num=monitor_data.v,p(o,f,l,c,h,num),l=l+h+2;var f=68,l=90,c=36,h=26;for(x in t)monitor_data=t[x],num=monitor_data.v,p(o,f,l,c,h,num),l=l+h+2;var f=106,l=90,c=36,h=26;for(x in n)monitor_data=n[x],num=monitor_data.v,p(o,f,l,c,h,num),l=l+h+2;var f=154,l=90,c=36,h=26;for(x in e)monitor_data=r[x],num=monitor_data.v,p(o,f,l,c,h,num),l=l+h+2;var f=192,l=90,c=36,h=26;for(x in t)monitor_data=i[x],num=monitor_data.v,p(o,f,l,c,h,num),l=l+h+2;var f=230,l=90,c=36,h=26;for(x in n)monitor_data=s[x],num=monitor_data.v,p(o,f,l,c,h,num),l=l+h+2;var f=286,l=90,c=36,h=26;for(x in n)monitor_data=s[x],pt=monitor_data.e,o.text(f,l+13,pt).attr({fill:"#C3CFD1","font-size":12,"font-weight":"bold","font-family":"微软雅黑","text-anchor":"start"}),l=l+h+2});var b=1e3,w=new THREE.Vector3(0,0,0),T={speed:3,multiplier:.5,backgroundColor:"#000000",zoom:1,spin:0,transitionTime:2e3},A=[],D=!0,P=!0,H=!1,B=document.getElementById("visualization"),j=document.getElementById("visualization"),F,I,q=document.getElementById("glContainer"),R="country_iso3166.txt",U="country_lat_lon.txt",z,W,X,V,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot=new Object,ut,at=[],ft=[],lt={"Military Weapons":"mil","Civilian Weapons":"civ",Ammunition:"ammo"},ct=new Object;for(var ht in lt){var pt=ht,dt=lt[ht];ct[dt]=pt}var vt={mil:14497804,civ:4045312,ammo:1393810},mt=1393810,gt=14497804,yt=null,bt=null,wt,Et=!1,St=[],Tt=function(){this.selectedYear="2010",this.selectedCountry="UNITED STATES",this.exportCategories=new Object,this.importCategories=new Object;for(var e in lt)this.exportCategories[e]=!0,this.importCategories[e]=!0;this.getExportCategories=function(){var e=[];for(var t in this.exportCategories)this.exportCategories[t]&&e.push(t);return e},this.getImportCategories=function(){var e=[];for(var t in this.importCategories)this.importCategories[t]&&e.push(t);return e}},At={PE:1,BF:2,FR:3,LY:4,BY:5,PK:6,ID:7,YE:8,MG:9,BO:10,CI:11,DZ:12,CH:13,CM:14,MK:15,BW:16,UA:17,KE:18,TW:19,JO:20,MX:21,AE:22,BZ:23,BR:24,SL:25,ML:26,CD:27,IT:28,SO:29,AF:30,BD:31,DO:32,GW:33,GH:34,AT:35,SE:36,TR:37,UG:38,MZ:39,JP:40,NZ:41,CU:42,VE:43,PT:44,CO:45,MR:46,AO:47,DE:48,SD:49,TH:50,AU:51,PG:52,IQ:53,HR:54,GL:55,NE:56,DK:57,LV:58,RO:59,ZM:60,IR:61,MM:62,ET:63,GT:64,SR:65,EH:66,CZ:67,TD:68,AL:69,FI:70,SY:71,KG:72,SB:73,OM:74,PA:75,AR:76,GB:77,CR:78,PY:79,GN:80,IE:81,NG:82,TN:83,PL:84,NA:85,ZA:86,EG:87,TZ:88,GE:89,SA:90,VN:91,RU:92,HT:93,BA:94,IN:95,CN:96,CA:97,SV:98,GY:99,BE:100,GQ:101,LS:102,BG:103,BI:104,DJ:105,AZ:106,MY:107,PH:108,UY:109,CG:110,RS:111,ME:112,EE:113,RW:114,AM:115,SN:116,TG:117,ES:118,GA:119,HU:120,MW:121,TJ:122,KH:123,KR:124,HN:125,IS:126,NI:127,CL:128,MA:129,LR:130,NL:131,CF:132,SK:133,LT:134,ZW:135,LK:136,IL:137,LA:138,KP:139,GR:140,TM:141,EC:142,BJ:143,SI:144,NO:145,MD:146,LB:147,NP:148,ER:149,US:150,KZ:151,AQ:152,SZ:153,UZ:154,MN:155,BT:156,NC:157,FJ:158,KW:159,TL:160,BS:161,VU:162,FK:163,GM:164,QA:165,JM:166,CY:167,PR:168,PS:169,BN:170,TT:171,CV:172,PF:173,WS:174,LU:175,KM:176,MU:177,FO:178,ST:179,AN:180,DM:181,TO:182,KI:183,FM:184,BH:185,AD:186,MP:187,PW:188,SC:189,AG:190,BB:191,TC:192,VC:193,LC:194,YT:195,VI:196,GD:197,MT:198,MV:199,KY:200,KN:201,MS:202,BL:203,NU:204,PM:205,CK:206,WF:207,AS:208,MH:209,AW:210,LI:211,VG:212,SH:213,JE:214,AI:215,MF_1_:216,GG:217,SM:218,BM:219,TV:220,NR:221,GI:222,PN:223,MC:224,VA:225,IM:226,GU:227,SG:228};$(function(){xt()})