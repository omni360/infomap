<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Document</title>
	<link href="../../css/base.css" rel="stylesheet">
	<link href="../../otherlib/customIcon/style.css" rel="stylesheet">
	<link rel="stylesheet" href="../../css/aa.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
</head>
<body>
<div class="link-picture-control clearfix">
	<div class="link-picture">
		<ul>
		
		</ul>
	</div>
	<div class="link-dot clearfix">
		<button id="left"></button>
		<button id="right"></button>

	</div>
	<div class="linka clearfix">
	<ul >
	</ul>
</div>
</div>
</body>
<script src="../../js/lib/jquery-2.0.2.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
var data = [
	{
		'id': '1',
		'name': '拓扑实时展示',
		'src':'../../image/topo_event_timer.png'
	},
	{
		'id': '2',
		'name': '历史拓扑回放',
		'src':'../../image/topo_event_timer.png'
	},
	{
		'id': '3',
		'name': '测试数据',
		'src':'../../image/topo_event_timer.png'
	},
	{
		'id': '4',
		'name': '测试数据',
		'src':'../../image/topo_event_timer.png'
	},
	{
		'id': '5',
		'name': '测试数据',
		'src':'../../image/topo_event_timer.png'
	},
	{
		'id': '6',
		'name': '测试数据',
		'src':'../../image/topo_event_timer.png'
	},
	{
		'id': '7',
		'name': '测试数据',
		'src':'../../image/topo_event_timer.png'
	},
]
$(function(){
	var imghtml='',dothtml='';
	var activeIndex = (data.length + 1)/2 - 1;
	for(var i in data){
		activeIndex == i ? imghtml+='<li>' : imghtml+='<li class="normalp">';
		imghtml+='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="图层_1" x="0px" y="0px" width="203.051px" height="189.708px" viewBox="0 0 203.051 189.708" enable-background="new 0 0 203.051 189.708" xml:space="preserve" xmlns:xml="http://www.w3.org/XML/1998/namespace"><g><path fill="rgba(14,165,204,0.1)" stroke="rgba(14,165,204,0.9)"  stroke-width="1.5" d="M201.632,19.971c0.022,0,0.036-0.443,0.036-0.984v-8.274   c0-0.54-0.439-1.025-0.979-1.078l-77.371-7.538c-0.538-0.054-1.21,0.283-1.491,0.744l-4.397,7.208   c-0.282,0.461-0.611,0.787-0.731,0.723c-0.121-0.064-0.661-0.117-1.202-0.117H2.983C2.443,10.655,2,11.098,2,11.638v164.396   c0,0.541,0.438,1.032,0.979,1.087l97.879,10.402c0.537,0.058,1.417,0.058,1.954,0l97.877-10.402   c0.539-0.057,0.964-0.104,0.942-0.104c-0.019,0-0.037-0.442-0.037-0.983V20.953C201.595,20.413,201.613,19.971,201.632,19.971z"/></g></svg>';
		imghtml+='<div class="link-picture-title">'+data[i].name+'</div><div class="link-picture-src"><img src="'+data[i].src+'" alt="" /></div>';
		imghtml+='<div class="link-picture-info"><button><i class="icon-eye"></i></button></div></li>';
		
		activeIndex == i ? dothtml+='<li class="linka-dot linka-active"></li>' : dothtml+='<li class="linka-dot"></li>';
		
	}
	$('.link-picture ul').html(imghtml);
	$('.linka ul').html(dothtml);
	
	$('.link-dot').css({
		'left': window.innerWidth/2 - 134
	});
	$('.link-picture ul li').css({
		'left': (window.innerWidth-348)/2
	});
	$('.linka').css({
		'left': (window.innerWidth - (data.length*15))/2
	});
	

	var lis = $('.link-picture ul li');
	var linka = $('.linka ul li'),
		transform = function(element, value, key) {
			key = key || "Transform";
			["Moz", "O", "Ms", "Webkit", ""].forEach(function(prefix) {
				element.style[prefix + key] = value;	
			});	
			
			return element;
		}
	
	changepicture(0,0);
	
	lis.each(function(i){
		$(this).click(function(){
			activeIndex = i;
			P(i);
			changepicture(0,0);
		})
	});
	
	linka.each(function(i){
		$(this).click(function(){
			activeIndex = i;
			P(i);
			changepicture(0,0);
		})
	});
	
	
	
	
	$('#right').click(function(){
		
		if(activeIndex == data.length -1 ) return false; 
		
		activeIndex++;
		
		changepicture(0,0);
		
	});
	$('#left').click(function(){
		if(activeIndex == 0) return false; 
		
		activeIndex--;
		
		changepicture(0,0);
	});
	
	function changepicture(_middle,_blank){
		_middle = 150, _blank = 110;
		linka.removeClass('linka-active');
		linka.eq(activeIndex).addClass('linka-active');
		lis.each(function(i){
			if(activeIndex > i){
				transform(this, "perspective(500px) scale(0.6) rotateY(45deg) translate3d("+((-_blank)*(activeIndex-i)-_middle)+"px,0,"+((-_blank)*(activeIndex-i)-_middle)+"px)");	
			}else if(activeIndex < i){
				transform(this, "perspective(500px) scale(0.6) rotateY(-45deg) translate3d("+((_blank)*(i-activeIndex)+_middle)+"px,0,"+((-_blank)*(i-activeIndex)-_middle)+"px)");	
			}else{
				transform(this, "perspective(500px) scale(1)");	
			}
			
		});
	}
	
	function P(info){
		console.info(info);
	}
});
</script>
</html>