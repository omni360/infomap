<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<title>RebuildWb</title>
	<link rel="stylesheet" href="../../css/base.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
	<link rel="stylesheet" href="../../rebuild/src/space2d/assets/css/main.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
	<link href="../../otherlib/font-awesome/css/font-awesome.css" rel="stylesheet">
	<link href="../../otherlib/customIcon/style.css" rel="stylesheet">
	<link rel="stylesheet" href="../../css/models.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
	
	<style type="text/css">
		.chart{
			position: absolute;
			bottom: 9px;
			left: 5px;
			
		}
		
		#container,#container2,#container3{
			height: 150px;
		}
		
		#findNode{
			position: absolute;
			top: 16px;
			left: 324px;
			
			background-color: rgba(0,0,0,0);
			border: 0px solid #cccccc;
			
			height: 17px;
			z-index: 10;
			width: 76px;
			font-size: 12px;
			/*font-weight: bold;*/
			font-family: "微软雅黑"; 
			padding: 0 2px;
			margin-bottom: 0;
			-webkit-border-radius: 1px;
			-moz-border-radius: 1px;
			border-radius: 1px;
			color: #ddd;
			letter-spacing: 1px;
			/*outline-offset: 2px;*/
		}
		
		#findNode:focus {
			box-shadow: none;
		}
		
	</style>
	
	
</head>
<body onload="init()">
	<!-- 实例主体 -->
	<div id="topo" style="widht:100%; height: -webkit-calc(100% + 10px) ;">
		
	</div>
	<input id="findNode" type="text" placeholder="节点ID"/>
	
	<div class="chart">
		<div class="chart-panel">
			<header class="chart-title" data="1">
				<span>模</span>
				<span>拟</span>
				<span>监</span>
				<span>控</span>
			</header>
			<div class="chart-body">
				<div id="container3"></div>
			</div>
		</div>
		<div class="chart-panel">
			<header class="chart-title" data="1">
				<span>流</span>
				<span>量</span>
				<span>监</span>
				<span>控</span>
			</header>
			<div class="chart-body">
				<div id="container"></div>
			</div>
		</div>
		<div class="chart-panel">
			<header class="chart-title" data="1">
				<span>应</span>
				<span>用</span>
				<span>统</span>
				<span>计</span>
				<span>监</span>
				<span>控</span>
			</header>
			<div class="chart-body">
				<div id="container2">
				</div>
			</div>
		</div>
	</div>
</body>
<!-- Libs-->
<script src="../../js/topoJson.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/libs/jquery-1.7.2.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="../../js/lib/slidemenu.js"></script>
<script src="../../js/lib/jquery.easing.1.3.js" type="text/javascript" charset="utf-8"></script>
<script src="../../otherlib/jqueryui/jquery-ui.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/libs/raphael-min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/libs/jquery.mousewheel.min.js"></script>
<script src="../../rebuild/src/libs/jquery.mCustomScrollbar.js"></script>
<script src="../../rebuild/src/libs/three.js" type="text/javascript" charset="utf-8"></script>
<!-- <script src="src/libs/effects/three.min.r52.js" type="text/javascript" charset="utf-8"></script> -->
<script src="../../rebuild/src/libs/Collisions.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/libs/TrackballControls.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/libs/Tween.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/lib/highcharts.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/libs/dark-green.js" type="text/javascript" charset="utf-8"></script>
<!-- 主类、材质、动画库-->
<script src="../../rebuild/src/OOPTEST.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/textures/TexturesLibrary.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/animations/Animation.js" type="text/javascript" charset="utf-8"></script>
<!-- 网关  -->
<script src="../../rebuild/src/gateways/Gateways.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/gateways/GatewayRequest.js" type="text/javascript" charset="utf-8"></script>
<!-- 场景视口-->
<script src="../../rebuild/src/space3d/scenes/Scene.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/scenes/Viewport.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/scenes/Scene.js" type="text/javascript" charset="utf-8"></script>
<!-- 模型-->
<script src="../../rebuild/src/space3d/models/Model.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/bases/Circle.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/bases/Arrow.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/bases/Mark.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/bases/DashedLine.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/Gyroscope.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/Floor.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/Star.js" type="text/javascript" charset="utf-8"></script>

<script src="../../rebuild/src/space2d/models/BaseSvgModel.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/models/ZoomRulerSvgModel.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/models/HostMenuSvgModel.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/models/MsgCardModel.js" type="text/javascript" charset="utf-8"></script>
<!-- 区块 -->
<script src="../../rebuild/src/space2d/functionspan/topoinfo/topoInfo.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/mapstyle/mapStyle.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/findNode/findNode.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/dynamichart/dynamiChart.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/showLog/replayLog.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/showLog/showLog.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/showLog/historyLog.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/menupanel/menuPanel.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/eventlist/eventList.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/replayBar/replayBar.js" type="text/javascript" charset="utf-8"></script>
<!-- 主体拓扑	-->
<script src="../../rebuild/src/space3d/models/bases/NodeSystem.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/models/TopoSystemTween.js" type="text/javascript" charset="utf-8"></script>
<!-- 人机交互事件 -->
<script src="../../rebuild/src/space3d/events/Event.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/events/ResizeEvent.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/events/RayEvent.js" type="text/javascript" charset="utf-8"></script>
<!-- 安全事件-->
<script src="../../rebuild/src/space3d/securevents/SecurEvent.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/securevents/FtpEventTween.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/securevents/MailEventTween.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space3d/securevents/WormEvent.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/showLog/MessageEvent.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/functionspan/showLog/historyMsgEvent.js" type="text/javascript" charset="utf-8"></script>
<!-- 工具类 -->
<script src="../../rebuild/src/space3d/utils/Utils.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/utils/ImgUnitls.js" type="text/javascript" charset="utf-8"></script>
<script src="../../rebuild/src/space2d/utils/StringUtils.js" type="text/javascript" charset="utf-8"></script>
<!-- 系统调度器-->
<script src="../../rebuild/src/system/AppConfigMain.js" type="text/javascript" charset="utf-8"></script>

<script src="chart_pie.js" type="text/javascript" charset="utf-8"></script>
<script src="chart_line.js" type="text/javascript" charset="utf-8"></script>
<script src="chart_bar.js" type="text/javascript" charset="utf-8"></script>

<!-- 着色器 -->
<!-- script src="src/libs/effects/shaders/ConvolutionShader.js"></script>
<script src="src/libs/effects/shaders/CopyShader.js"></script>
<script src="src/libs/effects/shaders/HorizontalBlurShader.js"></script>
<script src="src/libs/effects/shaders/VerticalBlurShader.js"></script>
<script src="src/libs/effects/shaders/FilmShader.js"></script>
<script src="src/libs/effects/shaders/FocusShader.js"></script>

<script src="src/libs/effects/EffectComposer.js"></script>
<script src="src/libs/effects/MaskPass.js"></script>
<script src="src/libs/effects/RenderPass.js"></script>
<script src="src/libs/effects/ShaderPass.js"></script>
<script src="src/libs/effects/BloomPass.js"></script>
<script src="src/libs/effects/FilmPass.js"></script -->

<script type="text/javascript" charset="utf-8">
	window.parent && (window.parent.topo.isRenderer = false);
	
	//屏蔽鼠标事件
    document.oncontextmenu = function (){
        return false;
    };
	var system;
	
	function init(){
		
		system = new OOPTEST.System('ALL', 'history');
		system.cameraRadius = 8000;
		system.cameraMaxRadius = 8000;
		system.update(topoJsonList[0]);
		
		// chart
		
		$('.chart-panel .chart-title').click(function(){
			var tempp = $(this).parent();
				temppd = tempp.find('.chart-body');
			if($(this).attr('data') == 1){
				// temppd.hide('normal');
				tempp.css({
					'width': '0',
				})
				temppd.css({
					'width': 0,
					'opacity': 0
				})
				$(this).attr({'data': 0}); 
			}else{
				tempp.css({
					'width': '300px',
				})
				temppd.css({
					'width': '100%',
					'opacity': 1
				})
				$(this).attr({'data': 1}); 
			}
		});
		
		var circle_Attr = {
			stroke: "#fff", 
			"stroke-opacity": 1, 
			"stroke-width": 2, 
			"fill-opacity": 1, 
			fill: "#12C2F6", 
			"fill-opacity": 1
		}, text_Attr = {
			fill: "#ddd", 
			"font-size":11, 
			"font-weight": "bold", 
			"font-family": "微软雅黑", 
			"text-anchor":"start"
		},line_Attr = {
			stroke: "rgba(14,165,204,1)", 
			"stroke-width": 2
		};
		
		
		Raphael(1,1,280,280,function(){
			var paper = this,
				padding = [155,10,10,10];
			
			paper.path('M0,0L10,10v190L0,210')
				.attr({stroke: "rgba(14,165,204,0.9)", "stroke-width": 2});

			
			function topoName(a,b,h,d,e){
				paper.path('M'+a+','+(b+12)+'h'+d).attr(line_Attr);
				paper.path('M'+a+','+(b+h-12)+'h'+d).attr(line_Attr);
				paper.path('M'+(a+d+e)+','+b+'h-'+e+'v'+h+'h'+e).attr(line_Attr);
			}
			
			topoName(10,52,57,17,12);
			
			
			function nodeChart(a,b,r,t,count,src,ir,theat,lr){
				theat = 20, lr = 27;
				var theat = Math.PI*theat/180;
				paper.path('M'+a+','+b+'L'+(a-Math.sin(theat)*lr)+','+(b+Math.cos(theat)*lr)).attr(line_Attr);
				paper.text(a,b-r-10,t).attr({
					fill: "#ddd", 
					"font-size":11,
					'letter-spacing': 2, 
					"font-weight": "bold", 
					"font-family": "微软雅黑", 
					"text-anchor":"middle"
				});	
				
				paper.text((a-Math.sin(theat)*lr),(b+Math.cos(theat)*lr)+6,count).attr({
					fill: "#ddd", 
					"font-size":11,
					// "font-weight": "bold", 
					"font-family": "微软雅黑", 
					"text-anchor":"middle"
				});	
				
				// paper.circle(a,b,r).attr(circle_Attr);	s
				
				paper.image(src,a-ir/2,b-ir/2,ir,ir);
			}
			
			paper.path('M'+10+','+padding[0]+'h270').attr(line_Attr);
			
			nodeChart(50,padding[0],15,'服务器',16,'../../rebuild/src/space3d/textures/images/topo_server.png',30);
			
			nodeChart(100,padding[0],15,'主机',100,'../../rebuild/src/space3d/textures/images/topo_host.png',30); 				
			nodeChart(150,padding[0],15,'路由器',0,'../../rebuild/src/space3d/textures/images/topo_router.png',30);			
			nodeChart(200,padding[0],15,'交换机',17,'../../rebuild/src/space3d/textures/images/topo_switch.png',30);			
			nodeChart(250,padding[0],15,'防火墙',4,'../../rebuild/src/space3d/textures/images/topo_firewall.png',30);
			// paper.path('M50,'+padding[0]+'v59h5').attr(line_Attr);
			// paper.text(57,(padding[0]+58),'服务器 143').attr(text_Attr);
			// paper.circle(50,padding[0],13).attr(circle_Attr);
// 				
			// paper.path('M100,'+padding[0]+'v46h5').attr(line_Attr);
			// paper.text(107,(padding[0]+45),'主机 36').attr(text_Attr);
			// paper.circle(100,padding[0],12).attr(circle_Attr);
// 				
			// paper.path('M150,'+padding[0]+'v33h5').attr(line_Attr);
			// paper.text(157,(padding[0]+32),'路由器 18').attr(text_Attr);
			// paper.circle(150,padding[0],10).attr(circle_Attr);
// 				
			// paper.path('M200,'+padding[0]+'v20h5').attr(line_Attr);
			// paper.text(207,(padding[0]+19),'交换机 10').attr(text_Attr);
			// paper.circle(200,padding[0],9).attr(circle_Attr);

			
// 				
			// paper.setSize(291.5,176);
// 
			// paper.setViewBox(0,0,265,160);
			
		});
		
		var color = [
			'#56A079',
			'#C2A84B',
			'#DF6C4F',
			'#BE1655'
		],colorbg = [
			'90-#246844-#327A54',
			'90-#7E691F-#A08833',
			'90-#903721-#B85036',
			'90-#7B0934-#9C0F44',
		]
		
		var buttonarys = [],
			activeBtn = -1;	
		Raphael(1,1,450,50,function(){
			var paper = this;

			function button(w,h,a,b,r,type,text,data){
				var bbb = paper.path(
					'M'+(a+5)+','+b+
					'L'+(a-r)+','+(b+r+5)+
					'v'+(h-2*r-5)+
					'L'+a+','+(b+h)+
					'h'+(w-2*r)+
					'L'+(a+w-r)+','+(b+h-r)+
					'v-'+(h-2*r)+
					'L'+(a+w-2*r)+','+b+
					'h-'+(w-2*r-5)+
					'z'
				).attr({
					stroke: color[type], 
					fill: color[type], 
					// fill: status? ('90-#246844-#327A54') : color[type], 
					'fill-opacity': 0.1,
					"stroke-width": 2
				});
				var x = -5,xl = 7
				paper.path('M'+(a+x+xl)+','+(b+x+r)+'h-'+xl+'v'+xl+'z').attr({
					fill: color[type], 
					"stroke-width": 0
				});
				
				var ttt = paper.text((a+w/2-r),(b+h/2)-0.1,text).attr({
					fill: "#C3CFD1", 
					"font-size":11,
					'letter-spacing': 2, 
					"font-weight": "bold", 
					"font-family": "微软雅黑", 
					"text-anchor":"middle"
				});
				
				buttonarys.push([bbb,ttt]);
				
				paper.path(
					'M'+(a+5)+','+b+
					'L'+(a-r)+','+(b+r+5)+
					'v'+(h-2*r-5)+
					'L'+a+','+(b+h)+
					'h'+(w-2*r)+
					'L'+(a+w-r)+','+(b+h-r)+
					'v-'+(h-2*r)+
					'L'+(a+w-2*r)+','+b+
					'h-'+(w-2*r-5)+
					'z'
				)
				.data('i',data)
				.data('io',0)
				.attr({
					stroke: "rgba(14,165,204,0)", 
	                "stroke-width": 2, 
	                'fill' : 'rgba(4, 63, 85, 0)'
				}).hover(function(){
					if(this.data('io') == 1) return false;
					buttonarys[this.data('i')][1].attr({
						'fill': '#FFF',
						"font-size":12,
					});
				},function(){
					if(this.data('io') == 1) return false;
					buttonarys[this.data('i')][1].attr({
						'fill': '#C3CFD1',
						"font-size":11,
					});
				}).click(function(){
					activeBtn > -1 && buttonarys[activeBtn][0].attr({
						fill: color[activeBtn], 
						'fill-opacity': 0.1,
					});
					buttonarys[this.data('i')][0].attr({
						fill: colorbg[this.data('i')], 
						'fill-opacity': 1,
					});
					
					activeBtn = this.data('i');
				});
			}
			
			button(52,24,30,12,3,0,'运行',0);
			
			button(52,24,97,12,3,1,'休眠',1);
			
			button(52,24,164,12,3,2,'暂停',2);
			
			button(52,24,231,12,3,3,'结束',3);
			
			function findbtn(w,h,a,b,r,type,text){
				paper.path(
					'M'+a+','+b+
					'L'+(a-r)+','+(b+r)+
					'v'+(h-2*r)+
					'L'+a+','+(b+h)+
					'h'+(w-2*r)+
					'L'+(a+w-r)+','+(b+h-r)+
					'v-'+(h-2*r)+
					'L'+(a+w-2*r)+','+b+
					'h-'+(w-2*r)+
					'z'+
					'M'+ (a+22)+ ',' + (b+4)+
					'v16'
				).attr({stroke: "rgba(14,165,204,0.9)", "stroke-width": 2});
				
				paper.path('M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z')
					 .attr({
					 	'fill': '#FFF',
					 	'stroke': '#FFF'
					 })
					 .transform('t'+(a-7)+','+(b-4.5)+'s0.5');
					 
				// paper.path('M'++'h')
				
			}
			
			findbtn(110,24,298,12,3,'','结束');
		});
		
		

	}
	
</script>
</html>